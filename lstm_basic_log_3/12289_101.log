[2021-06-13 02:00:14,469] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-13 02:00:18,231] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-13 02:00:19,132] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-13 02:00:19,132] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-13 02:00:19,133] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-13 02:00:19,133] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-13 02:00:19,133] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623549625.0363655
before load_ogb step Time(s): 0.0020
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.17578125, 'VmSize': 20395.0078125, 'VmHWM': 1164.7109375, 'VmRSS': 1164.7109375}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6948
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2833
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0780
-------------------------------------------------end of load ogb****************** step Time(s): 0.0020
finish constructing ogbn-products
load ogb-products time total: 2.0597851276397705
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0608
after inductive else step Time(s): 0.0001
after label step Time(s): 3.6675
after train_g.create_formats_() step Time(s): 1.5859
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-13 02:00:32,385] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-13 02:00:32,387] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-13 02:00:32,391] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-13 02:00:34,789] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-13 02:00:34,791] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-13 02:00:34,792] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-13 02:00:34,792] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-13 02:00:34,792] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-13 02:00:34,792] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f9ea1a11908>
[2021-06-13 02:00:34,792] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:00:34,792] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-13 02:00:34,792] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-13 02:00:34,793] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-13 02:00:34,794] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-13 02:00:34,795] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2875003814697266  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.73876953125GB

Max Memory Allocated 1.2875003814697266  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.42041015625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.42041015625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.43603515625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.43603515625GB

Max Memory Allocated 16.616300106048584  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7810 | Train Acc 0.0318 | Speed (samples/sec) nan | GPU 17015.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.39697265625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.39697265625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.42041015625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.31298828125GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.30322265625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.30712890625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.30712890625GB

Max Memory Allocated 16.616300106048584  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.26806640625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.26806640625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.29150390625GB

Max Memory Allocated 16.616300106048584  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41259765625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41259765625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41259765625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41259765625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

[2021-06-13 02:00:41,789] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-13 02:00:41,847] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4939.178651199913
-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41259765625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41259765625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.45947265625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 16.68641996383667  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.41455078125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 16.68641996383667  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

avg iteration(step) data from cpu to GPU time:17.71307338 ms
avg iteration GPU training time:300.36796154 ms
avg iteration (step) total cpu time:330.46085184 ms
Epoch Time(s): 9.3174
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33642578125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.0239 | Train Acc 0.7293 | Speed (samples/sec) 34696.4093 | GPU 17113.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33642578125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

[2021-06-13 02:00:47,416] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:00:47,478] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4875.927619780473
-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33642578125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

[2021-06-13 02:00:50,808] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:00:50,870] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=4898.589898548799
-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

avg iteration(step) data from cpu to GPU time:18.14434017 ms
avg iteration GPU training time:303.05516746 ms
avg iteration (step) total cpu time:337.35140887 ms
Epoch Time(s): 7.7210
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33642578125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.5833 | Train Acc 0.8645 | Speed (samples/sec) 34489.2884 | GPU 17113.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

[2021-06-13 02:00:56,683] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:00:56,744] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4852.986587688998
-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34619140625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33642578125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.29931640625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33642578125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32470703125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.34814453125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.33837890625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.34033203125GB

Max Memory Allocated 16.712810516357422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.30126953125GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.32275390625GB

Max Memory Allocated 16.712810516357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.88262714 ms
avg iteration GPU training time:325.82243763 ms
avg iteration (step) total cpu time:356.97520863 ms
Epoch Time(s): 7.9932
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.4675 | Train Acc 0.8864 | Speed (samples/sec) 34006.9746 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:02,382] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:02,442] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4814.994125909074
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:05,915] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:05,977] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4792.906070601916
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.46147503 ms
avg iteration GPU training time:311.98752663 ms
avg iteration (step) total cpu time:343.82809292 ms
Epoch Time(s): 7.7338
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4399 | Train Acc 0.8873 | Speed (samples/sec) 33918.9235 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:11,572] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:11,627] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=4796.364342465378
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:14,949] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:15,007] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=4817.138755037097
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:19.04026465 ms
avg iteration GPU training time:302.41311923 ms
avg iteration (step) total cpu time:337.88605170 ms
Epoch Time(s): 7.7260
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3812 | Train Acc 0.9037 | Speed (samples/sec) 33959.1420 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:20,798] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:20,860] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=4780.554312694538
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:19.01963928 ms
avg iteration GPU training time:308.67077637 ms
avg iteration (step) total cpu time:340.36471627 ms
Epoch Time(s): 7.8973
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3613 | Train Acc 0.9059 | Speed (samples/sec) 33857.5260 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:26,489] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:26,551] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=4785.369165452673
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:29,969] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:30,031] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=4787.222148636424
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:20.46931804 ms
avg iteration GPU training time:309.17668291 ms
avg iteration (step) total cpu time:344.37667240 ms
Epoch Time(s): 7.7858
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3553 | Train Acc 0.9048 | Speed (samples/sec) 33831.5833 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:35,552] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:35,614] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=4794.141638924076
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23486328125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18798828125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:20.29658474 ms
avg iteration GPU training time:311.45709229 ms
avg iteration (step) total cpu time:345.63847022 ms
Epoch Time(s): 7.6917
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22509765625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3284 | Train Acc 0.9133 | Speed (samples/sec) 33822.9817 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:41,151] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:41,212] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=4795.714183983437
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21142578125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:44,675] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:44,736] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=4788.416507342042
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.94062857 ms
avg iteration GPU training time:308.71656938 ms
avg iteration (step) total cpu time:339.67778899 ms
Epoch Time(s): 7.6337
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3380 | Train Acc 0.9120 | Speed (samples/sec) 33827.2770 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:50,415] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:50,476] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=4777.36414241396
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.24072265625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:53,755] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:53,817] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=4788.774967495056
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.64469788 ms
avg iteration GPU training time:307.22538619 ms
avg iteration (step) total cpu time:338.62233162 ms
Epoch Time(s): 7.8204
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3240 | Train Acc 0.9144 | Speed (samples/sec) 33802.3941 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:01:59,615] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:01:59,675] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=4774.870823109087
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.00634471 ms
avg iteration GPU training time:313.73050204 ms
avg iteration (step) total cpu time:348.48440777 ms
Epoch Time(s): 7.8422
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3375 | Train Acc 0.9114 | Speed (samples/sec) 33714.9267 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:05,501] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:05,562] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=4775.137040113321
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:08,912] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:08,969] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=4781.117180730506
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.68864562 ms
avg iteration GPU training time:310.28624933 ms
avg iteration (step) total cpu time:342.25487709 ms
Epoch Time(s): 7.9823
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3122 | Train Acc 0.9133 | Speed (samples/sec) 33734.1950 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:14,698] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:14,758] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=4780.152542681946
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.90835502 ms
avg iteration GPU training time:302.77446955 ms
avg iteration (step) total cpu time:333.54206519 ms
Epoch Time(s): 7.7022
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3053 | Train Acc 0.9197 | Speed (samples/sec) 33807.0570 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:20,136] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:20,196] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=4788.267268333205
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:23,549] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:23,611] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=4793.662447095871
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.89264315 ms
avg iteration GPU training time:302.62100220 ms
avg iteration (step) total cpu time:335.91641079 ms
Epoch Time(s): 7.5503
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3055 | Train Acc 0.9175 | Speed (samples/sec) 33851.6886 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:29,146] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:29,207] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=4797.672782214708
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:32,584] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:32,642] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=4797.358442475437
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.70707182 ms
avg iteration GPU training time:312.96194458 ms
avg iteration (step) total cpu time:345.93900767 ms
Epoch Time(s): 7.7636
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3042 | Train Acc 0.9173 | Speed (samples/sec) 33836.9887 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:38,339] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:38,401] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=4793.503598547629
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.01763517 ms
avg iteration GPU training time:307.60860929 ms
avg iteration (step) total cpu time:338.45656568 ms
Epoch Time(s): 7.7285
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2964 | Train Acc 0.9184 | Speed (samples/sec) 33828.3885 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:43,890] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:43,952] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=4797.17318305618
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:47,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:47,328] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=4803.381920487011
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.82940787 ms
avg iteration GPU training time:302.87726662 ms
avg iteration (step) total cpu time:337.75570176 ms
Epoch Time(s): 7.5780
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.2849 | Train Acc 0.9234 | Speed (samples/sec) 33862.2760 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:52,985] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:53,046] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=4800.485252197304
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.65826641 ms
avg iteration GPU training time:302.79573753 ms
avg iteration (step) total cpu time:334.00763165 ms
Epoch Time(s): 7.6816
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2895 | Train Acc 0.9193 | Speed (samples/sec) 33885.6522 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:02:58,522] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:02:58,583] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=4803.230411035546
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:02,009] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:02,070] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=4803.960949255488
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:19.07501411 ms
avg iteration GPU training time:302.58202293 ms
avg iteration (step) total cpu time:334.82198282 ms
Epoch Time(s): 7.7022
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2897 | Train Acc 0.9225 | Speed (samples/sec) 33883.5451 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:07,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:07,710] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=4802.069900784295
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:10,963] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:11,021] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=4808.46467709149
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.95274787 ms
avg iteration GPU training time:300.49304477 ms
avg iteration (step) total cpu time:332.18782598 ms
Epoch Time(s): 7.6425
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2872 | Train Acc 0.9217 | Speed (samples/sec) 33901.1334 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:16,530] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:16,588] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=4811.171693725681
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.72166963 ms
avg iteration GPU training time:311.46075994 ms
avg iteration (step) total cpu time:342.25195104 ms
Epoch Time(s): 7.7121
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2780 | Train Acc 0.9239 | Speed (samples/sec) 33910.7606 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:22,355] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:22,416] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=4803.449790180343
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:25,823] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:25,879] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=4802.950325996334
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.88862541 ms
avg iteration GPU training time:315.99305864 ms
avg iteration (step) total cpu time:347.48868509 ms
Epoch Time(s): 7.8565
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.2993 | Train Acc 0.9166 | Speed (samples/sec) 33866.9102 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:31,638] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:31,699] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=4792.294483939209
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.98533821 ms
avg iteration GPU training time:309.87127963 ms
avg iteration (step) total cpu time:342.24930677 ms
Epoch Time(s): 7.8439
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2764 | Train Acc 0.9251 | Speed (samples/sec) 33837.1097 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:37,320] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:37,380] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=4793.713903039233
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:40,871] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:40,934] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=4790.842833856354
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.12695902 ms
avg iteration GPU training time:313.54196167 ms
avg iteration (step) total cpu time:345.76255625 ms
Epoch Time(s): 7.8922
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2842 | Train Acc 0.9234 | Speed (samples/sec) 33825.7924 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:46,528] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:46,591] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=4792.87504714417
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:50,119] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:50,176] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=4787.861538664249
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:19.13797829 ms
avg iteration GPU training time:326.85728038 ms
avg iteration (step) total cpu time:358.98726637 ms
Epoch Time(s): 7.8675
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2886 | Train Acc 0.9210 | Speed (samples/sec) 33788.8642 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:03:55,867] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:03:55,929] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=4784.667974481182
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.97245095 ms
avg iteration GPU training time:309.31057462 ms
avg iteration (step) total cpu time:339.67713876 ms
Epoch Time(s): 7.7137
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2707 | Train Acc 0.9260 | Speed (samples/sec) 33795.4273 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:01,471] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:01,533] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=4787.556054898438
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:04,914] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:04,975] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=4788.676061522534
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.98824154 ms
avg iteration GPU training time:304.41125211 ms
avg iteration (step) total cpu time:334.79781584 ms
Epoch Time(s): 7.7598
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2768 | Train Acc 0.9242 | Speed (samples/sec) 33815.6246 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:10,638] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:10,699] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=4787.604889997779
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.19595320 ms
avg iteration GPU training time:316.27856168 ms
avg iteration (step) total cpu time:350.60750354 ms
Epoch Time(s): 7.8033
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2742 | Train Acc 0.9240 | Speed (samples/sec) 33785.8694 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:16,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:16,358] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=4784.426117204231
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:19,937] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:19,999] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=4778.6922032740995
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.39633768 ms
avg iteration GPU training time:320.70876798 ms
avg iteration (step) total cpu time:351.66718743 ms
Epoch Time(s): 7.8631
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2739 | Train Acc 0.9245 | Speed (samples/sec) 33746.2319 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:25,590] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:25,651] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=4779.288900099208
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:29,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:29,188] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=4776.3608074385775
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.76108204 ms
avg iteration GPU training time:324.72653753 ms
avg iteration (step) total cpu time:355.34689643 ms
Epoch Time(s): 7.8455
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2901 | Train Acc 0.9225 | Speed (samples/sec) 33725.2507 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:34,866] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:34,930] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=4773.399364525101
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.81936888 ms
avg iteration GPU training time:304.21008856 ms
avg iteration (step) total cpu time:334.58488638 ms
Epoch Time(s): 7.7533
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2996 | Train Acc 0.9190 | Speed (samples/sec) 33731.6050 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:40,532] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:40,594] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=4772.811890626366
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:44,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:44,080] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=4772.511719978465
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.94733672 ms
avg iteration GPU training time:318.10647583 ms
avg iteration (step) total cpu time:350.59599443 ms
Epoch Time(s): 7.8726
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2861 | Train Acc 0.9249 | Speed (samples/sec) 33704.9145 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:49,692] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:49,753] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=4772.288807884654
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:19.21411514 ms
avg iteration GPU training time:298.29397860 ms
avg iteration (step) total cpu time:329.27898927 ms
Epoch Time(s): 7.5594
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2768 | Train Acc 0.9251 | Speed (samples/sec) 33736.4359 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:55,189] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:55,250] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=4776.805325182579
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:04:58,571] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:04:58,629] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=4779.871181270894
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.46524828 ms
avg iteration GPU training time:308.53695401 ms
avg iteration (step) total cpu time:341.07867154 ms
Epoch Time(s): 7.6333
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2874 | Train Acc 0.9203 | Speed (samples/sec) 33752.0236 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:04,340] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:04,404] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=4775.662440692982
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:07,848] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:07,906] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=4774.444166594351
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:19.09905763 ms
avg iteration GPU training time:320.20050604 ms
avg iteration (step) total cpu time:351.58133507 ms
Epoch Time(s): 7.9378
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2704 | Train Acc 0.9267 | Speed (samples/sec) 33730.9447 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:13,603] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:13,665] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=4773.0768890738655
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.72319135 ms
avg iteration GPU training time:299.92199430 ms
avg iteration (step) total cpu time:331.51509545 ms
Epoch Time(s): 7.6693
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2518 | Train Acc 0.9295 | Speed (samples/sec) 33740.3453 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:19,157] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:19,218] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=4773.783102239706
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:22,494] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:22,555] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=4777.428641809934
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.51311996 ms
avg iteration GPU training time:300.47318337 ms
avg iteration (step) total cpu time:332.82882517 ms
Epoch Time(s): 7.5803
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2628 | Train Acc 0.9287 | Speed (samples/sec) 33760.1835 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:28,206] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:28,267] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=4776.118571121631
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.83918225 ms
avg iteration GPU training time:324.56674749 ms
avg iteration (step) total cpu time:355.92887618 ms
Epoch Time(s): 7.9518
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2757 | Train Acc 0.9259 | Speed (samples/sec) 33737.2678 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:33,989] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:34,051] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=4773.964328910595
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:37,313] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:37,376] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=4777.474512516509
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38060535 ms
avg iteration GPU training time:306.62329934 ms
avg iteration (step) total cpu time:337.56535703 ms
Epoch Time(s): 7.6317
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2764 | Train Acc 0.9255 | Speed (samples/sec) 33757.9133 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:42,951] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:43,012] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=4777.773916519799
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:46,297] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:46,359] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=4780.3347587883845
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.80850913 ms
avg iteration GPU training time:303.45685369 ms
avg iteration (step) total cpu time:334.66781269 ms
Epoch Time(s): 7.6207
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2748 | Train Acc 0.9262 | Speed (samples/sec) 33774.9287 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:51,938] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:51,996] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=4782.189794112657
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.95179055 ms
avg iteration GPU training time:311.38851374 ms
avg iteration (step) total cpu time:342.75382215 ms
Epoch Time(s): 7.6928
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2825 | Train Acc 0.9220 | Speed (samples/sec) 33785.4032 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:05:57,551] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:05:57,612] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=4781.711741361392
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:00,891] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:00,954] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=4784.290897838512
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.60712138 ms
avg iteration GPU training time:304.57573076 ms
avg iteration (step) total cpu time:335.22566882 ms
Epoch Time(s): 7.5763
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2709 | Train Acc 0.9239 | Speed (samples/sec) 33802.7671 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:06,675] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:06,736] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=4781.988176740197
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:17.96865168 ms
avg iteration GPU training time:315.49713690 ms
avg iteration (step) total cpu time:346.94929556 ms
Epoch Time(s): 7.8383
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2768 | Train Acc 0.9245 | Speed (samples/sec) 33785.7663 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:12,310] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:12,366] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=4780.777964157171
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:15,683] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:15,744] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=4782.669453332929
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:16.80010770 ms
avg iteration GPU training time:302.15806718 ms
avg iteration (step) total cpu time:331.67979934 ms
Epoch Time(s): 7.5951
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2687 | Train Acc 0.9268 | Speed (samples/sec) 33804.5360 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:21,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:21,451] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=4782.7244232195535
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:24,668] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:24,731] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=4786.42042213237
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

avg iteration(step) data from cpu to GPU time:18.51196809 ms
avg iteration GPU training time:300.65034069 ms
avg iteration (step) total cpu time:332.42674307 ms
Epoch Time(s): 7.6335
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2800 | Train Acc 0.9233 | Speed (samples/sec) 33823.7656 | GPU 17156.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes

[2021-06-13 02:06:30,298] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:30,360] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=4787.446218787425
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.754570960998535  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.754570960998535  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.07645676 ms
avg iteration GPU training time:301.25120406 ms
avg iteration (step) total cpu time:331.53839545 ms
Epoch Time(s): 7.5888
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2731 | Train Acc 0.9241 | Speed (samples/sec) 33841.2015 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:06:36,331] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:36,392] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=4787.964328574983
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:06:39,976] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:40,034] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=4785.9640641181995
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:17.63690758 ms
avg iteration GPU training time:320.36099243 ms
avg iteration (step) total cpu time:355.19257459 ms
Epoch Time(s): 8.4400
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2651 | Train Acc 0.9267 | Speed (samples/sec) 33809.6152 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:06:46,042] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:46,104] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=4778.10332577517
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.24049742 ms
avg iteration GPU training time:317.38947366 ms
avg iteration (step) total cpu time:350.27332739 ms
Epoch Time(s): 8.0719
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2743 | Train Acc 0.9226 | Speed (samples/sec) 33776.8847 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:06:51,670] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:51,732] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=4778.690727937509
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:06:55,308] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:06:55,364] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=4776.413283879199
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.45065013 ms
avg iteration GPU training time:321.38308716 ms
avg iteration (step) total cpu time:355.58759082 ms
Epoch Time(s): 7.9218
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2622 | Train Acc 0.9286 | Speed (samples/sec) 33750.8652 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:07:01,003] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:07:01,064] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=4774.7872237131805
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:07:04,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:07:04,403] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=4777.041909334154
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.41259644 ms
avg iteration GPU training time:303.06259155 ms
avg iteration (step) total cpu time:334.51466127 ms
Epoch Time(s): 7.6298
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2659 | Train Acc 0.9246 | Speed (samples/sec) 33758.8303 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:07:10,323] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:07:10,387] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=4776.696178654482
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.87690457 ms
avg iteration GPU training time:307.40284590 ms
avg iteration (step) total cpu time:342.14154157 ms
Epoch Time(s): 7.9428
Eval Acc 0.9140
Test Acc: 0.7653
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2629 | Train Acc 0.9291 | Speed (samples/sec) 33767.8499 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:10,245] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:10,308] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=4778.508466072416
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:13,657] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:13,721] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=4779.855972515511
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.46448881 ms
avg iteration GPU training time:308.70959750 ms
avg iteration (step) total cpu time:341.29903533 ms
Epoch Time(s): 7.7612
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2648 | Train Acc 0.9284 | Speed (samples/sec) 33774.3808 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:19,484] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:19,548] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=4777.960964481093
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.53118550 ms
avg iteration GPU training time:313.41616821 ms
avg iteration (step) total cpu time:346.34160995 ms
Epoch Time(s): 7.7953
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2507 | Train Acc 0.9298 | Speed (samples/sec) 33767.0811 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:25,179] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:25,242] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=4777.920793323851
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:28,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:28,770] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=4776.916699786374
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.24115779 ms
avg iteration GPU training time:311.70910645 ms
avg iteration (step) total cpu time:343.05498817 ms
Epoch Time(s): 7.8854
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2700 | Train Acc 0.9239 | Speed (samples/sec) 33761.9367 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:34,429] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:34,492] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=4776.463398035694
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:37,802] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:37,862] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=4777.748928161846
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:17.27528719 ms
avg iteration GPU training time:310.75104592 ms
avg iteration (step) total cpu time:340.82828869 ms
Epoch Time(s): 7.6683
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2808 | Train Acc 0.9208 | Speed (samples/sec) 33765.5331 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:43,678] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:43,741] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=4774.658267431948
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.74179493 ms
avg iteration GPU training time:321.30104204 ms
avg iteration (step) total cpu time:358.63817822 ms
Epoch Time(s): 8.0140
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2713 | Train Acc 0.9256 | Speed (samples/sec) 33742.8025 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:49,550] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:49,614] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=4773.022302589038
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:53,193] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:53,255] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=4770.717978501178
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.78480582 ms
avg iteration GPU training time:325.16224532 ms
avg iteration (step) total cpu time:359.65956341 ms
Epoch Time(s): 8.0696
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2603 | Train Acc 0.9274 | Speed (samples/sec) 33718.6911 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:08:58,896] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:08:58,958] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=4769.940585771291
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.39748088 ms
avg iteration GPU training time:304.26135809 ms
avg iteration (step) total cpu time:338.53838661 ms
Epoch Time(s): 7.7352
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2703 | Train Acc 0.9268 | Speed (samples/sec) 33724.1190 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:04,605] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:04,668] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=4771.417052303838
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:08,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:08,156] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=4771.442892283201
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.56490759 ms
avg iteration GPU training time:302.58883944 ms
avg iteration (step) total cpu time:336.07175133 ms
Epoch Time(s): 7.8217
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2696 | Train Acc 0.9260 | Speed (samples/sec) 33727.9974 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:13,750] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:13,813] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=4773.224492263845
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:17,060] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:17,123] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=4775.900909022892
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.55776007 ms
avg iteration GPU training time:302.15163630 ms
avg iteration (step) total cpu time:335.27476137 ms
Epoch Time(s): 7.6307
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2624 | Train Acc 0.9283 | Speed (samples/sec) 33744.5739 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:22,652] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:22,714] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=4776.893631465903
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:20.17730609 ms
avg iteration GPU training time:303.31229747 ms
avg iteration (step) total cpu time:336.28060601 ms
Epoch Time(s): 7.6574
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2785 | Train Acc 0.9242 | Speed (samples/sec) 33757.8475 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:28,775] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:28,837] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=4778.338308484007
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:32,480] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:32,543] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=4779.679986909618
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.53964788 ms
avg iteration GPU training time:303.38088434 ms
avg iteration (step) total cpu time:335.24504575 ms
Epoch Time(s): 8.4633
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2810 | Train Acc 0.9232 | Speed (samples/sec) 33755.9731 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:38,049] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:38,111] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=4780.924594241053
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.00027344 ms
avg iteration GPU training time:326.19509610 ms
avg iteration (step) total cpu time:359.80963707 ms
Epoch Time(s): 7.7792
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2605 | Train Acc 0.9245 | Speed (samples/sec) 33742.4488 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:44,002] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:44,065] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=4778.368450710298
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:47,688] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:47,751] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=4775.296962722202
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.67361745 ms
avg iteration GPU training time:323.27327659 ms
avg iteration (step) total cpu time:356.52405565 ms
Epoch Time(s): 8.1477
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2770 | Train Acc 0.9247 | Speed (samples/sec) 33721.7043 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:53,444] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:53,507] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=4776.680572374746
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:09:56,777] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:09:56,840] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=4778.980569323163
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.29900794 ms
avg iteration GPU training time:298.60676436 ms
avg iteration (step) total cpu time:334.85265212 ms
Epoch Time(s): 7.7005
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2954 | Train Acc 0.9181 | Speed (samples/sec) 33735.6676 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:02,610] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:02,673] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=4778.756058853412
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.57659045 ms
avg iteration GPU training time:295.03692350 ms
avg iteration (step) total cpu time:326.48483190 ms
Epoch Time(s): 7.8129
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2659 | Train Acc 0.9277 | Speed (samples/sec) 33748.0845 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:08,387] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:08,450] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=4778.92862305476
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:12,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:12,116] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=4776.074328545729
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.71697478 ms
avg iteration GPU training time:331.24362737 ms
avg iteration (step) total cpu time:362.65440421 ms
Epoch Time(s): 8.1867
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2640 | Train Acc 0.9270 | Speed (samples/sec) 33720.9442 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:17,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:18,049] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=4774.5834851666405
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:20.85968312 ms
avg iteration GPU training time:303.68112737 ms
avg iteration (step) total cpu time:337.71870353 ms
Epoch Time(s): 7.9135
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2595 | Train Acc 0.9298 | Speed (samples/sec) 33722.0577 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:23,679] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:23,742] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=4776.842247862153
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:27,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:27,155] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=4777.922515346799
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.33894990 ms
avg iteration GPU training time:305.19318737 ms
avg iteration (step) total cpu time:338.10871298 ms
Epoch Time(s): 7.7446
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2713 | Train Acc 0.9253 | Speed (samples/sec) 33731.2006 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:33,056] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:33,119] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=4776.996110614892
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:36,487] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:36,550] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=4777.136583297004
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:17.66639120 ms
avg iteration GPU training time:314.97256470 ms
avg iteration (step) total cpu time:344.83203021 ms
Epoch Time(s): 8.0465
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2694 | Train Acc 0.9251 | Speed (samples/sec) 33726.0020 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:42,334] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:42,398] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=4776.097082158212
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:20.37746065 ms
avg iteration GPU training time:305.96330123 ms
avg iteration (step) total cpu time:340.58804946 ms
Epoch Time(s): 7.8506
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2679 | Train Acc 0.9263 | Speed (samples/sec) 33729.0605 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:48,027] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:48,090] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=4778.064086082999
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:51,412] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:51,474] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=4779.4695630617225
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.53723093 ms
avg iteration GPU training time:306.84639671 ms
avg iteration (step) total cpu time:339.47238055 ms
Epoch Time(s): 7.7615
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2751 | Train Acc 0.9262 | Speed (samples/sec) 33737.0262 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:10:57,240] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:10:57,303] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=4778.075383795725
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.01752455 ms
avg iteration GPU training time:310.22328047 ms
avg iteration (step) total cpu time:341.51907401 ms
Epoch Time(s): 7.7784
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2529 | Train Acc 0.9313 | Speed (samples/sec) 33740.2002 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:02,922] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:02,986] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=4778.53615450318
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:06,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:06,488] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=4778.147685558876
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.58511422 ms
avg iteration GPU training time:306.45033403 ms
avg iteration (step) total cpu time:338.24385296 ms
Epoch Time(s): 7.8658
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2648 | Train Acc 0.9264 | Speed (samples/sec) 33739.1199 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:12,250] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:12,314] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=4777.265768952248
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:15,839] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:15,902] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=4775.714080923993
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.21268671 ms
avg iteration GPU training time:327.46851973 ms
avg iteration (step) total cpu time:359.59653421 ms
Epoch Time(s): 8.0932
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2731 | Train Acc 0.9247 | Speed (samples/sec) 33718.5732 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:21,662] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:21,726] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=4775.446837380669
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.33631411 ms
avg iteration GPU training time:307.80129450 ms
avg iteration (step) total cpu time:341.31028435 ms
Epoch Time(s): 7.8320
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2651 | Train Acc 0.9263 | Speed (samples/sec) 33721.0022 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:27,387] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:27,449] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=4775.525119434238
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:30,735] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:30,798] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=4777.065751129069
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.02887552 ms
avg iteration GPU training time:298.15542603 ms
avg iteration (step) total cpu time:330.03887263 ms
Epoch Time(s): 7.7199
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2648 | Train Acc 0.9264 | Speed (samples/sec) 33728.7553 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:36,497] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:36,561] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=4777.471866151092
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.28847712 ms
avg iteration GPU training time:301.11884932 ms
avg iteration (step) total cpu time:332.72056146 ms
Epoch Time(s): 7.7331
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2676 | Train Acc 0.9264 | Speed (samples/sec) 33738.5329 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:42,127] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:42,189] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=4778.775694320322
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:45,568] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:45,632] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=4779.371831004536
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.33018771 ms
avg iteration GPU training time:306.09863281 ms
avg iteration (step) total cpu time:340.45460007 ms
Epoch Time(s): 7.7471
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2573 | Train Acc 0.9282 | Speed (samples/sec) 33746.5715 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:51,244] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:51,307] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=4780.757742524973
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:11:54,504] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:11:54,567] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=4783.14865280846
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.81824875 ms
avg iteration GPU training time:295.31649503 ms
avg iteration (step) total cpu time:327.48428258 ms
Epoch Time(s): 7.5993
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2635 | Train Acc 0.9264 | Speed (samples/sec) 33764.2725 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:00,280] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:00,343] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=4782.5252609020445
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.51085385 ms
avg iteration GPU training time:297.87405673 ms
avg iteration (step) total cpu time:330.05142212 ms
Epoch Time(s): 7.8235
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2655 | Train Acc 0.9260 | Speed (samples/sec) 33770.7828 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:05,962] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:06,024] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=4783.752574585331
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:09,354] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:09,417] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=4784.59839074466
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.54570181 ms
avg iteration GPU training time:307.26724521 ms
avg iteration (step) total cpu time:340.03175389 ms
Epoch Time(s): 7.7535
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2750 | Train Acc 0.9229 | Speed (samples/sec) 33777.9254 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:15,216] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:15,279] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=4783.141821687308
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.99661064 ms
avg iteration GPU training time:313.52794300 ms
avg iteration (step) total cpu time:346.01909464 ms
Epoch Time(s): 7.9044
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2729 | Train Acc 0.9255 | Speed (samples/sec) 33771.2983 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:20,949] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:21,010] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=4783.4407624263085
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:24,285] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:24,348] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=4785.185250485233
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.08464865 ms
avg iteration GPU training time:295.97208196 ms
avg iteration (step) total cpu time:328.41836322 ms
Epoch Time(s): 7.6633
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2567 | Train Acc 0.9284 | Speed (samples/sec) 33784.0746 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:30,019] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:30,082] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=4785.289169638338
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:33,432] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:33,495] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=4785.7399203741525
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.61694232 ms
avg iteration GPU training time:311.62013661 ms
avg iteration (step) total cpu time:342.96891906 ms
Epoch Time(s): 7.8044
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2646 | Train Acc 0.9274 | Speed (samples/sec) 33784.2250 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:40,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:40,571] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=4782.915492645597
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:20.18225999 ms
avg iteration GPU training time:334.41896473 ms
avg iteration (step) total cpu time:421.92912102 ms
Epoch Time(s): 9.3318
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2785 | Train Acc 0.9195 | Speed (samples/sec) 33728.0611 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:46,828] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:46,890] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=4780.622877611457
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:50,582] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:50,645] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=4777.712212073959
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.83098186 ms
avg iteration GPU training time:336.66376565 ms
avg iteration (step) total cpu time:370.21578442 ms
Epoch Time(s): 8.5588
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2727 | Train Acc 0.9234 | Speed (samples/sec) 33690.2435 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:12:56,570] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:12:56,633] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=4776.087382905084
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.27316076 ms
avg iteration GPU training time:320.48399492 ms
avg iteration (step) total cpu time:353.43933105 ms
Epoch Time(s): 8.0800
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2726 | Train Acc 0.9246 | Speed (samples/sec) 33679.2325 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:02,257] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:02,320] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=4775.171850530684
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:05,577] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:05,640] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=4776.760041229089
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.36658929 ms
avg iteration GPU training time:295.85262507 ms
avg iteration (step) total cpu time:326.90923864 ms
Epoch Time(s): 7.4451
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2595 | Train Acc 0.9266 | Speed (samples/sec) 33695.7532 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:11,253] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:11,317] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=4776.863980222742
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:14,661] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:14,725] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=4777.600465622985
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.94321147 ms
avg iteration GPU training time:306.76166049 ms
avg iteration (step) total cpu time:340.05173770 ms
Epoch Time(s): 7.8312
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2686 | Train Acc 0.9251 | Speed (samples/sec) 33695.5018 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:20,231] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:20,293] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=4778.499402672906
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.07567995 ms
avg iteration GPU training time:298.60680043 ms
avg iteration (step) total cpu time:331.86156099 ms
Epoch Time(s): 7.5645
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2587 | Train Acc 0.9252 | Speed (samples/sec) 33709.4502 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:25,871] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:25,934] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=4779.465148945008
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:29,222] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:29,286] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=4780.721522538585
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.95451338 ms
avg iteration GPU training time:301.26460405 ms
avg iteration (step) total cpu time:333.22910829 ms
Epoch Time(s): 7.6831
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2738 | Train Acc 0.9246 | Speed (samples/sec) 33720.3516 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:34,747] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:34,808] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=4782.417592690145
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:17.64210042 ms
avg iteration GPU training time:302.79200883 ms
avg iteration (step) total cpu time:333.10829509 ms
Epoch Time(s): 7.5510
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2744 | Train Acc 0.9231 | Speed (samples/sec) 33734.7339 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:40,432] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:40,494] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=4782.959856309353
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:43,841] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:43,905] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=4783.622836914522
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.35264015 ms
avg iteration GPU training time:300.81231412 ms
avg iteration (step) total cpu time:333.31914382 ms
Epoch Time(s): 7.6691
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2648 | Train Acc 0.9267 | Speed (samples/sec) 33745.0207 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:49,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:49,571] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=4783.187687310834
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:52,817] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:52,881] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=4784.650211731299
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.84882285 ms
avg iteration GPU training time:302.14000355 ms
avg iteration (step) total cpu time:334.46901495 ms
Epoch Time(s): 7.6601
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2690 | Train Acc 0.9264 | Speed (samples/sec) 33747.7627 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:13:58,502] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:13:58,565] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=4784.877530019027
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:17.89463876 ms
avg iteration GPU training time:294.58995750 ms
avg iteration (step) total cpu time:326.61516016 ms
Epoch Time(s): 7.6584
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2627 | Train Acc 0.9279 | Speed (samples/sec) 33758.9775 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:04,097] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:04,161] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=4785.723370516438
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:07,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:07,452] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=4787.377510928589
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.65734412 ms
avg iteration GPU training time:295.67641380 ms
avg iteration (step) total cpu time:326.69639587 ms
Epoch Time(s): 7.5772
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2671 | Train Acc 0.9277 | Speed (samples/sec) 33772.8561 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:13,248] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:13,310] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=4786.670892220734
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.28937288 ms
avg iteration GPU training time:300.66152122 ms
avg iteration (step) total cpu time:331.83813095 ms
Epoch Time(s): 7.8445
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2595 | Train Acc 0.9286 | Speed (samples/sec) 33778.1561 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:18,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:18,767] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=4788.20120562443
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:22,150] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:22,213] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=4788.254600235881
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:17.54643458 ms
avg iteration GPU training time:313.71373957 ms
avg iteration (step) total cpu time:344.17993372 ms
Epoch Time(s): 7.6346
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2744 | Train Acc 0.9270 | Speed (samples/sec) 33780.2664 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:27,866] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:27,929] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=4787.48267887839
-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:31,139] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:31,202] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=4789.196888728031
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30806420 ms
avg iteration GPU training time:296.26024836 ms
avg iteration (step) total cpu time:328.13057032 ms
Epoch Time(s): 7.7054
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2712 | Train Acc 0.9252 | Speed (samples/sec) 33787.8899 | GPU 17159.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.18994140625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

[2021-06-13 02:14:36,810] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 02:14:36,874] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=4790.59524989923
-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21533203125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23876953125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.23095703125GB

Max Memory Allocated 16.75739812850952  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.19189453125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.21337890625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.23681640625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.22705078125GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.22900390625GB

Max Memory Allocated 16.75739812850952  GigaBytes

avg iteration(step) data from cpu to GPU time:19.80737166 ms
avg iteration GPU training time:295.25643089 ms
avg iteration (step) total cpu time:332.70393718 ms
Epoch Time(s): 7.5862
Eval Acc 0.9115
Test Acc: 0.7477
Avg epoch time(time.time()): 7806.724275151889 ms
total avg iteration(step) data from cpu to GPU time:18.64885325 ms
total avg iteration GPU training time:308.74157924 ms
total avg iteration (step) total cpu time:341.63490488 ms
