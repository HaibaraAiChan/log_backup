[2021-06-13 01:46:43,479] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-13 01:46:47,185] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_mini_batch.py --batch-size 24577 --deepspeed_config ds_config.json
[2021-06-13 01:46:48,149] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-13 01:46:48,149] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-13 01:46:48,149] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-13 01:46:48,149] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-13 01:46:48,149] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623548813.7615573
before load_ogb step Time(s): 0.0018
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.171875, 'VmSize': 20395.00390625, 'VmHWM': 1164.60546875, 'VmRSS': 1164.60546875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6557
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2828
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0012
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0767
-------------------------------------------------end of load ogb****************** step Time(s): 0.0023
finish constructing ogbn-products
load ogb-products time total: 2.0189409255981445
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0199
after inductive else step Time(s): 0.0000
after label step Time(s): 3.7938
after train_g.create_formats_() step Time(s): 1.7059
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-13 01:47:01,314] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-13 01:47:01,316] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-13 01:47:01,319] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-13 01:47:03,693] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-13 01:47:03,695] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-13 01:47:03,695] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-13 01:47:03,695] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-13 01:47:03,695] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-13 01:47:03,695] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f5391bb9908>
[2021-06-13 01:47:03,695] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:47:03,695] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-13 01:47:03,695] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-13 01:47:03,696] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-13 01:47:03,697] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-13 01:47:03,698] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.3896312713623047  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.85791015625GB

Max Memory Allocated 1.3896312713623047  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.16259765625GB

Max Memory Allocated 27.306640148162842  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.16259765625GB

Max Memory Allocated 27.306640148162842  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.18798828125GB

Max Memory Allocated 27.306640148162842  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.18798828125GB

Max Memory Allocated 27.306640148162842  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7992 | Train Acc 0.0309 | Speed (samples/sec) nan | GPU 27962.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.12548828125GB

Max Memory Allocated 27.306640148162842  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.12548828125GB

Max Memory Allocated 27.306640148162842  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.16455078125GB

Max Memory Allocated 27.306640148162842  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.81298828125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.76025390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.76025390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33642578125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.30908203125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31884765625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31884765625GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.25439453125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.25439453125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29345703125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33447265625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.31884765625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.31884765625GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.25439453125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.25439453125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29345703125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33642578125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.32080078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.32080078125GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29736328125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33837890625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31298828125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.26025390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.26025390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33837890625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31298828125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29736328125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33837890625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31494140625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

avg iteration(step) data from cpu to GPU time:29.85355695 ms
avg iteration GPU training time:471.47338867 ms
avg iteration (step) total cpu time:519.09852028 ms
Epoch Time(s): 8.5292
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29736328125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33642578125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31103515625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.32080078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.32080078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.7383 | Train Acc 0.5206 | Speed (samples/sec) 41356.5357 | GPU 28035.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.25830078125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29736328125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.33837890625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.31298828125GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

[2021-06-13 01:47:15,843] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-13 01:47:15,956] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=3242.196517828759
-----------------------------------------after batch engine step
 Nvidia-smi: 31.32275390625GB

Max Memory Allocated 27.37839984893799  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.26025390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.26025390625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.29931640625GB

Max Memory Allocated 27.37839984893799  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28759765625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29736328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29736328125GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23291015625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23291015625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43603515625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38134765625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38134765625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42041015625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42431640625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43994140625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

avg iteration(step) data from cpu to GPU time:22.17883746 ms
avg iteration GPU training time:427.95502726 ms
avg iteration (step) total cpu time:465.12214343 ms
Epoch Time(s): 7.4048
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.0152 | Train Acc 0.7368 | Speed (samples/sec) 42283.4216 | GPU 28066.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46142578125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43994140625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

[2021-06-13 01:47:24,077] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:47:24,188] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=3180.294354312493
-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42431640625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46533203125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.40886354446411  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38330078125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42236328125GB

Max Memory Allocated 27.40886354446411  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.43798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:26.52645365 ms
avg iteration GPU training time:466.97972616 ms
avg iteration (step) total cpu time:511.71906789 ms
Epoch Time(s): 6.8717
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.7164 | Train Acc 0.8295 | Speed (samples/sec) 43301.1405 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38720703125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38720703125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38720703125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38720703125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42626953125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

[2021-06-13 01:47:32,115] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:47:32,226] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=3259.9781851116577
-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:22.37741852 ms
avg iteration GPU training time:426.29889933 ms
avg iteration (step) total cpu time:465.54954847 ms
Epoch Time(s): 6.9655
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5743 | Train Acc 0.8654 | Speed (samples/sec) 44080.7435 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

[2021-06-13 01:47:40,212] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:47:40,325] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=3288.22563764429
-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:25.85531743 ms
avg iteration GPU training time:435.65512085 ms
avg iteration (step) total cpu time:479.19130325 ms
Epoch Time(s): 7.1969
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.4908 | Train Acc 0.8832 | Speed (samples/sec) 44224.5122 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:28.42492803 ms
avg iteration GPU training time:432.02303060 ms
avg iteration (step) total cpu time:476.24246279 ms
Epoch Time(s): 6.8373
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.4458 | Train Acc 0.8899 | Speed (samples/sec) 44693.3551 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

[2021-06-13 01:47:50,960] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:47:51,072] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=3333.4256274263485
-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.39111328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44384765625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:24.08099238 ms
avg iteration GPU training time:407.03731283 ms
avg iteration (step) total cpu time:446.62229220 ms
Epoch Time(s): 6.6341
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.46728515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.44189453125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.4214 | Train Acc 0.8945 | Speed (samples/sec) 45201.8687 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.38916015625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.42822265625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96533203125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93994140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

[2021-06-13 01:47:58,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:47:58,725] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=3373.6692347628664
-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96533203125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93994140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:23.83617020 ms
avg iteration GPU training time:421.71402995 ms
avg iteration (step) total cpu time:461.15446091 ms
Epoch Time(s): 6.7025
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3920 | Train Acc 0.9001 | Speed (samples/sec) 45428.4028 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93994140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93603515625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

[2021-06-13 01:48:06,520] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:06,633] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=3395.5599161278406
-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96533203125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93994140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:26.89873060 ms
avg iteration GPU training time:421.40250651 ms
avg iteration (step) total cpu time:465.91830254 ms
Epoch Time(s): 7.0250
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3851 | Train Acc 0.9013 | Speed (samples/sec) 45548.0392 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94580078125GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93994140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93994140625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

[2021-06-13 01:48:14,231] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:14,343] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=3400.9112793088325
-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

avg iteration(step) data from cpu to GPU time:25.94476827 ms
avg iteration GPU training time:424.33697510 ms
avg iteration (step) total cpu time:466.18692080 ms
Epoch Time(s): 6.7906
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3678 | Train Acc 0.9041 | Speed (samples/sec) 45598.8774 | GPU 28106.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88330078125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.96337890625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.93798828125GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.94775390625GB

Max Memory Allocated 27.447370529174805  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.88525390625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.92431640625GB

Max Memory Allocated 27.447370529174805  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31689453125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28955078125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31298828125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28759765625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29736328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29736328125GB

Max Memory Allocated 27.45050287246704  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28955078125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23681640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23681640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28759765625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29736328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29736328125GB

Max Memory Allocated 27.45050287246704  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31494140625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28955078125GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

avg iteration(step) data from cpu to GPU time:25.76605860 ms
avg iteration GPU training time:430.08980306 ms
avg iteration (step) total cpu time:472.73898125 ms
Epoch Time(s): 7.3686
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23681640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23681640625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27587890625GB

Max Memory Allocated 27.45050287246704  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.31689453125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28955078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3620 | Train Acc 0.9071 | Speed (samples/sec) 45342.0469 | GPU 28113.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.23486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

[2021-06-13 01:48:25,489] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:25,598] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=3358.6635069259773
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77392578125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

avg iteration(step) data from cpu to GPU time:25.89250120 ms
avg iteration GPU training time:422.49891154 ms
avg iteration (step) total cpu time:462.80090014 ms
Epoch Time(s): 6.7050
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77392578125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.74853515625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.75830078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3596 | Train Acc 0.9050 | Speed (samples/sec) 45472.1686 | GPU 28113.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73486328125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

[2021-06-13 01:48:33,096] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:33,208] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=3376.93513625772
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

avg iteration(step) data from cpu to GPU time:29.10637792 ms
avg iteration GPU training time:423.88536580 ms
avg iteration (step) total cpu time:468.32958857 ms
Epoch Time(s): 6.7515
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3291 | Train Acc 0.9139 | Speed (samples/sec) 45582.1423 | GPU 28113.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

[2021-06-13 01:48:40,910] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:41,017] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=3385.3089134795378
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

avg iteration(step) data from cpu to GPU time:30.11158435 ms
avg iteration GPU training time:431.90948486 ms
avg iteration (step) total cpu time:483.31872622 ms
Epoch Time(s): 6.7449
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3389 | Train Acc 0.9095 | Speed (samples/sec) 45574.4473 | GPU 28113.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

[2021-06-13 01:48:48,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:48,801] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=3391.8327129646705
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

avg iteration(step) data from cpu to GPU time:25.57259687 ms
avg iteration GPU training time:428.66822306 ms
avg iteration (step) total cpu time:470.25871277 ms
Epoch Time(s): 6.8804
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.45438003540039  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3221 | Train Acc 0.9139 | Speed (samples/sec) 45613.1318 | GPU 28113.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.45438003540039  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

avg iteration(step) data from cpu to GPU time:27.82957840 ms
avg iteration GPU training time:422.09009806 ms
avg iteration (step) total cpu time:467.14552244 ms
Epoch Time(s): 6.5845
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.3268 | Train Acc 0.9122 | Speed (samples/sec) 45709.8593 | GPU 28114.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

[2021-06-13 01:48:59,108] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:48:59,221] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=3404.0233792546956
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

avg iteration(step) data from cpu to GPU time:24.59326935 ms
avg iteration GPU training time:436.10753377 ms
avg iteration (step) total cpu time:478.48423322 ms
Epoch Time(s): 6.6891
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3091 | Train Acc 0.9165 | Speed (samples/sec) 45729.9864 | GPU 28114.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

[2021-06-13 01:49:07,026] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:07,139] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=3401.219153719037
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

avg iteration(step) data from cpu to GPU time:33.37149811 ms
avg iteration GPU training time:432.31707764 ms
avg iteration (step) total cpu time:482.43482908 ms
Epoch Time(s): 6.9819
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.3111 | Train Acc 0.9168 | Speed (samples/sec) 45651.6144 | GPU 28114.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

[2021-06-13 01:49:14,838] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:14,951] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=3400.600875800122
-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

avg iteration(step) data from cpu to GPU time:25.13242722 ms
avg iteration GPU training time:440.93255615 ms
avg iteration (step) total cpu time:483.40932528 ms
Epoch Time(s): 6.8296
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.3173 | Train Acc 0.9163 | Speed (samples/sec) 45613.9684 | GPU 28114.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76220703125GB

Max Memory Allocated 27.455363750457764  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69970703125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.455363750457764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35205078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27001953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27001953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.30908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35205078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33642578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33642578125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.31103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35009765625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27197265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.31103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:49:23,095] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:23,208] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=3378.3104445802296
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:30.89106178 ms
avg iteration GPU training time:425.59170532 ms
avg iteration (step) total cpu time:472.15080261 ms
Epoch Time(s): 7.2727
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.73876953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77783203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.81884765625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.3068 | Train Acc 0.9172 | Speed (samples/sec) 45470.4480 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82080078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79541015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78173828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82080078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82080078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79541015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78173828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79541015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82080078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82080078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79541015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.97691727 ms
avg iteration GPU training time:425.52559408 ms
avg iteration (step) total cpu time:468.39348475 ms
Epoch Time(s): 6.6806
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79541015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.3026 | Train Acc 0.9184 | Speed (samples/sec) 45508.8628 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74267578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78173828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:49:33,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:33,808] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=3384.2543131540197
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:27.09952100 ms
avg iteration GPU training time:425.06389364 ms
avg iteration (step) total cpu time:468.44514211 ms
Epoch Time(s): 6.7946
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3092 | Train Acc 0.9167 | Speed (samples/sec) 45553.6512 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:49:41,333] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:41,446] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=3389.3008685596865
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:28.84853363 ms
avg iteration GPU training time:431.37224325 ms
avg iteration (step) total cpu time:476.41118368 ms
Epoch Time(s): 6.6810
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2981 | Train Acc 0.9196 | Speed (samples/sec) 45570.0639 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:49:48,978] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:49,090] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=3395.270454460767
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.32405281 ms
avg iteration GPU training time:422.87444051 ms
avg iteration (step) total cpu time:464.67351913 ms
Epoch Time(s): 6.6796
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2959 | Train Acc 0.9198 | Speed (samples/sec) 45635.5869 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:49:56,650] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:49:56,763] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=3398.440646373927
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.60741361 ms
avg iteration GPU training time:434.92672729 ms
avg iteration (step) total cpu time:478.67751122 ms
Epoch Time(s): 6.7213
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2943 | Train Acc 0.9194 | Speed (samples/sec) 45641.9525 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.45656522 ms
avg iteration GPU training time:418.78284709 ms
avg iteration (step) total cpu time:461.44572894 ms
Epoch Time(s): 7.3687
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2923 | Train Acc 0.9209 | Speed (samples/sec) 45637.4342 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:08,072] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:08,184] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=3401.3993142611753
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:24.09263929 ms
avg iteration GPU training time:426.24667358 ms
avg iteration (step) total cpu time:467.92999903 ms
Epoch Time(s): 6.9598
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2862 | Train Acc 0.9227 | Speed (samples/sec) 45663.8941 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.81884765625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74072265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.77978515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:16,380] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:16,484] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=3403.548399349262
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:22.30444845 ms
avg iteration GPU training time:428.10064697 ms
avg iteration (step) total cpu time:467.24327405 ms
Epoch Time(s): 7.2811
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2869 | Train Acc 0.9237 | Speed (samples/sec) 45613.7838 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74853515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74853515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78759765625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82275390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79736328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:24,014] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:24,127] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=3403.4499401602693
-----------------------------------------after batch engine step
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.79931640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82470703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:24.41341845 ms
avg iteration GPU training time:454.74786377 ms
avg iteration (step) total cpu time:497.72270521 ms
Epoch Time(s): 6.7523
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74462890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78369140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80126953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2867 | Train Acc 0.9211 | Speed (samples/sec) 45575.4625 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82666015625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81103515625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78564453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:31,925] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:32,039] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=3405.1763558061393
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.79391988 ms
avg iteration GPU training time:435.35768636 ms
avg iteration (step) total cpu time:479.72901662 ms
Epoch Time(s): 6.9289
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2909 | Train Acc 0.9203 | Speed (samples/sec) 45592.1396 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.14343452 ms
avg iteration GPU training time:425.68196615 ms
avg iteration (step) total cpu time:465.46991666 ms
Epoch Time(s): 6.9044
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2942 | Train Acc 0.9198 | Speed (samples/sec) 45611.9124 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:42,695] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:42,805] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=3408.0740360341347
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.99764252 ms
avg iteration GPU training time:438.17391968 ms
avg iteration (step) total cpu time:483.73913765 ms
Epoch Time(s): 6.7686
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2791 | Train Acc 0.9241 | Speed (samples/sec) 45620.8249 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:50,468] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:50,581] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=3409.5118055839066
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:28.88858668 ms
avg iteration GPU training time:429.39102173 ms
avg iteration (step) total cpu time:474.86964862 ms
Epoch Time(s): 6.8218
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2735 | Train Acc 0.9248 | Speed (samples/sec) 45624.3943 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:50:58,432] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:50:58,545] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=3411.906870565514
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:32.82745616 ms
avg iteration GPU training time:434.19564819 ms
avg iteration (step) total cpu time:484.17615891 ms
Epoch Time(s): 7.0083
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2779 | Train Acc 0.9239 | Speed (samples/sec) 45629.2516 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:06,195] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:06,307] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=3414.0124918880533
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.27251244 ms
avg iteration GPU training time:429.23563639 ms
avg iteration (step) total cpu time:468.99644534 ms
Epoch Time(s): 6.7415
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2914 | Train Acc 0.9198 | Speed (samples/sec) 45644.0367 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:24.52348836 ms
avg iteration GPU training time:433.75664266 ms
avg iteration (step) total cpu time:473.77649943 ms
Epoch Time(s): 6.9221
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2663 | Train Acc 0.9276 | Speed (samples/sec) 45639.2813 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:17,132] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:17,239] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=3411.715363498454
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.45368449 ms
avg iteration GPU training time:428.74041748 ms
avg iteration (step) total cpu time:470.56969007 ms
Epoch Time(s): 6.9287
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2830 | Train Acc 0.9234 | Speed (samples/sec) 45649.8395 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:25,015] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:25,128] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=3411.099257127856
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.65501849 ms
avg iteration GPU training time:422.92272949 ms
avg iteration (step) total cpu time:467.47048696 ms
Epoch Time(s): 6.8710
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2707 | Train Acc 0.9255 | Speed (samples/sec) 45640.0184 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:32,693] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:32,805] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=3413.1600556944213
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:28.32309405 ms
avg iteration GPU training time:423.68713379 ms
avg iteration (step) total cpu time:471.34113312 ms
Epoch Time(s): 6.7673
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2786 | Train Acc 0.9249 | Speed (samples/sec) 45637.1728 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:40,429] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:40,541] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=3414.9158859662048
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:30.40445836 ms
avg iteration GPU training time:436.32489014 ms
avg iteration (step) total cpu time:485.77594757 ms
Epoch Time(s): 6.7546
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2743 | Train Acc 0.9251 | Speed (samples/sec) 45637.5595 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:27.15108299 ms
avg iteration GPU training time:431.71464030 ms
avg iteration (step) total cpu time:477.25105286 ms
Epoch Time(s): 6.8216
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2862 | Train Acc 0.9225 | Speed (samples/sec) 45649.5028 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:51,400] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:51,514] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=3415.600607318868
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.54970678 ms
avg iteration GPU training time:429.23019409 ms
avg iteration (step) total cpu time:469.96808052 ms
Epoch Time(s): 7.0323
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2757 | Train Acc 0.9234 | Speed (samples/sec) 45674.2353 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:51:58,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:51:59,111] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=3417.6628372453793
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.20390383 ms
avg iteration GPU training time:432.73858643 ms
avg iteration (step) total cpu time:478.50910823 ms
Epoch Time(s): 6.6649
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2872 | Train Acc 0.9203 | Speed (samples/sec) 45690.9818 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:52:06,842] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:52:06,955] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=3417.824788036448
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.07134946 ms
avg iteration GPU training time:429.68916829 ms
avg iteration (step) total cpu time:469.87183889 ms
Epoch Time(s): 6.8669
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2724 | Train Acc 0.9254 | Speed (samples/sec) 45691.1816 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:52:14,594] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:52:14,707] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=3421.0427510054424
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.61479441 ms
avg iteration GPU training time:411.01765951 ms
avg iteration (step) total cpu time:452.24555333 ms
Epoch Time(s): 6.8048
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2642 | Train Acc 0.9263 | Speed (samples/sec) 45699.2093 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:27.48741341 ms
avg iteration GPU training time:426.69990031 ms
avg iteration (step) total cpu time:470.80723445 ms
Epoch Time(s): 6.7095
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2780 | Train Acc 0.9255 | Speed (samples/sec) 45701.3580 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:52:25,334] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:52:25,448] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=3420.864891055999
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.14812787 ms
avg iteration GPU training time:439.39143880 ms
avg iteration (step) total cpu time:480.12598356 ms
Epoch Time(s): 6.9390
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2642 | Train Acc 0.9275 | Speed (samples/sec) 45690.3285 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:52:33,320] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:52:33,429] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=3419.251301876888
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.79969025 ms
avg iteration GPU training time:435.93879191 ms
avg iteration (step) total cpu time:478.25598717 ms
Epoch Time(s): 7.0167
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2714 | Train Acc 0.9258 | Speed (samples/sec) 45684.6649 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:52:41,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:52:41,243] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=3418.11004013916
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.56661352 ms
avg iteration GPU training time:447.83133952 ms
avg iteration (step) total cpu time:491.85840289 ms
Epoch Time(s): 6.8078
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2644 | Train Acc 0.9275 | Speed (samples/sec) 45656.3266 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:52:48,791] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:52:48,905] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=3419.994772979444
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:28.77453868 ms
avg iteration GPU training time:430.60640462 ms
avg iteration (step) total cpu time:474.06482697 ms
Epoch Time(s): 6.7479
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2796 | Train Acc 0.9226 | Speed (samples/sec) 45672.6980 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.93175507 ms
avg iteration GPU training time:423.85154215 ms
avg iteration (step) total cpu time:465.24175008 ms
Epoch Time(s): 6.8617
Eval Acc 0.9157
Test Acc: 0.7607
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2633 | Train Acc 0.9279 | Speed (samples/sec) 45696.4019 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:53:40,817] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:53:40,929] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=3420.9534980430776
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:28.27797381 ms
avg iteration GPU training time:420.33237712 ms
avg iteration (step) total cpu time:466.59986178 ms
Epoch Time(s): 6.8502
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2646 | Train Acc 0.9286 | Speed (samples/sec) 45701.1295 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:53:48,702] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:53:48,813] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=3421.8957295981363
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.95817566 ms
avg iteration GPU training time:430.62827555 ms
avg iteration (step) total cpu time:470.96363703 ms
Epoch Time(s): 6.9024
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2592 | Train Acc 0.9277 | Speed (samples/sec) 45717.3115 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:53:56,617] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:53:56,729] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=3419.658575697332
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:32.53937085 ms
avg iteration GPU training time:455.84362793 ms
avg iteration (step) total cpu time:509.30190086 ms
Epoch Time(s): 7.0778
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2574 | Train Acc 0.9294 | Speed (samples/sec) 45669.3714 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:04,579] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:04,687] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=3419.0595055187164
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:27.46921539 ms
avg iteration GPU training time:428.35578410 ms
avg iteration (step) total cpu time:471.47456805 ms
Epoch Time(s): 6.9209
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2805 | Train Acc 0.9222 | Speed (samples/sec) 45668.5966 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:34.89593697 ms
avg iteration GPU training time:426.60878499 ms
avg iteration (step) total cpu time:477.67647107 ms
Epoch Time(s): 7.6081
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2578 | Train Acc 0.9288 | Speed (samples/sec) 45664.5459 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:16,244] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:16,357] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=3417.867257800943
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.38397853 ms
avg iteration GPU training time:465.44314575 ms
avg iteration (step) total cpu time:506.64806366 ms
Epoch Time(s): 7.1799
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2513 | Train Acc 0.9299 | Speed (samples/sec) 45608.0829 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:24,482] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:24,595] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=3412.609186494044
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:21.80168533 ms
avg iteration GPU training time:457.97658285 ms
avg iteration (step) total cpu time:496.82378769 ms
Epoch Time(s): 7.1955
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2649 | Train Acc 0.9278 | Speed (samples/sec) 45569.1593 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:32,571] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:32,684] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=3411.1908162427153
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:24.84483210 ms
avg iteration GPU training time:427.19700114 ms
avg iteration (step) total cpu time:467.97895432 ms
Epoch Time(s): 6.9932
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2599 | Train Acc 0.9271 | Speed (samples/sec) 45576.9430 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:40,670] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:40,776] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=3409.1839863594005
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:32.01669312 ms
avg iteration GPU training time:449.18695068 ms
avg iteration (step) total cpu time:495.58639526 ms
Epoch Time(s): 7.0968
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2543 | Train Acc 0.9290 | Speed (samples/sec) 45546.0881 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.58222898 ms
avg iteration GPU training time:433.48365275 ms
avg iteration (step) total cpu time:478.90996933 ms
Epoch Time(s): 6.7836
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2569 | Train Acc 0.9282 | Speed (samples/sec) 45553.2657 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:51,414] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:51,526] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=3410.1104306110506
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.85586103 ms
avg iteration GPU training time:423.39545695 ms
avg iteration (step) total cpu time:466.63602193 ms
Epoch Time(s): 6.7616
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2638 | Train Acc 0.9286 | Speed (samples/sec) 45576.2419 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:54:59,229] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:54:59,343] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=3411.3238707315413
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80322265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:24.43161647 ms
avg iteration GPU training time:427.57706706 ms
avg iteration (step) total cpu time:466.96297328 ms
Epoch Time(s): 6.9146
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2565 | Train Acc 0.9275 | Speed (samples/sec) 45579.7987 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:55:06,941] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:55:07,049] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=3412.9181753188473
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:23.90236791 ms
avg iteration GPU training time:432.24996948 ms
avg iteration (step) total cpu time:470.79571088 ms
Epoch Time(s): 6.7959
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2627 | Train Acc 0.9266 | Speed (samples/sec) 45598.5545 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.82861328125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81298828125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.78955078125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:55:15,160] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:55:15,274] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=3409.2324817545777
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.39342880 ms
avg iteration GPU training time:463.69170125 ms
avg iteration (step) total cpu time:506.50342306 ms
Epoch Time(s): 7.2863
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2743 | Train Acc 0.9233 | Speed (samples/sec) 45554.0163 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:24.79294904 ms
avg iteration GPU training time:426.98686727 ms
avg iteration (step) total cpu time:471.24425570 ms
Epoch Time(s): 6.9220
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2479 | Train Acc 0.9312 | Speed (samples/sec) 45564.9235 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:55:26,488] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:55:26,599] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=3409.742985065201
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:27.58643150 ms
avg iteration GPU training time:432.95121257 ms
avg iteration (step) total cpu time:476.38813655 ms
Epoch Time(s): 7.3241
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2556 | Train Acc 0.9306 | Speed (samples/sec) 45555.6751 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:55:34,474] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:55:34,587] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=3409.236851219531
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:28.98749797 ms
avg iteration GPU training time:425.41118368 ms
avg iteration (step) total cpu time:473.18092982 ms
Epoch Time(s): 6.9320
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2580 | Train Acc 0.9299 | Speed (samples/sec) 45557.7195 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:55:42,393] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:55:42,505] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=3409.587930863844
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.07629903 ms
avg iteration GPU training time:425.83035278 ms
avg iteration (step) total cpu time:468.18542480 ms
Epoch Time(s): 6.9569
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2627 | Train Acc 0.9273 | Speed (samples/sec) 45562.5364 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:55:50,070] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:55:50,184] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=3411.212300502149
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.69360034 ms
avg iteration GPU training time:422.73035685 ms
avg iteration (step) total cpu time:465.38885434 ms
Epoch Time(s): 6.7436
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2530 | Train Acc 0.9313 | Speed (samples/sec) 45573.7177 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:26.92208989 ms
avg iteration GPU training time:434.26713053 ms
avg iteration (step) total cpu time:479.29533323 ms
Epoch Time(s): 7.1113
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2656 | Train Acc 0.9263 | Speed (samples/sec) 45557.1372 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:56:01,184] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:01,296] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=3409.0602530590127
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.94729614 ms
avg iteration GPU training time:455.11196899 ms
avg iteration (step) total cpu time:497.98782667 ms
Epoch Time(s): 7.0559
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2587 | Train Acc 0.9300 | Speed (samples/sec) 45532.6927 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:56:09,231] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:09,344] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=3407.103037082801
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:29.43273608 ms
avg iteration GPU training time:429.73856608 ms
avg iteration (step) total cpu time:474.57249959 ms
Epoch Time(s): 6.9619
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2467 | Train Acc 0.9313 | Speed (samples/sec) 45531.2036 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83447265625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:56:17,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:17,233] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=3409.3771436128254
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83056640625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80517578125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81494140625GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:25.13242594 ms
avg iteration GPU training time:408.48577881 ms
avg iteration (step) total cpu time:451.08032227 ms
Epoch Time(s): 6.8154
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2593 | Train Acc 0.9285 | Speed (samples/sec) 45567.3473 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80908203125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

[2021-06-13 01:56:25,009] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:25,123] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=3407.4954439749454
-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

avg iteration(step) data from cpu to GPU time:31.39644814 ms
avg iteration GPU training time:444.92202759 ms
avg iteration (step) total cpu time:491.97459221 ms
Epoch Time(s): 6.9829
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2606 | Train Acc 0.9282 | Speed (samples/sec) 45531.1664 | GPU 28194.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75244140625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79150390625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.83251953125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.80712890625GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.81689453125GB

Max Memory Allocated 27.53323984146118  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.75439453125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.79345703125GB

Max Memory Allocated 27.53323984146118  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35595703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.32861328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.27392578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.31298828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.35986328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.33642578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.34423828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.34423828125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.28173828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.28173828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.32080078125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43017578125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.46923828125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:24.10868263 ms
avg iteration GPU training time:435.81338501 ms
avg iteration (step) total cpu time:474.77078438 ms
Epoch Time(s): 8.1249
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2517 | Train Acc 0.9307 | Speed (samples/sec) 45477.2916 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:56:37,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:37,143] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=3399.3740956800407
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:31.30421384 ms
avg iteration GPU training time:425.22124227 ms
avg iteration (step) total cpu time:474.30809339 ms
Epoch Time(s): 6.8270
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2550 | Train Acc 0.9282 | Speed (samples/sec) 45484.0796 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:56:44,949] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:45,062] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=3400.5184089748363
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.01011276 ms
avg iteration GPU training time:423.72521973 ms
avg iteration (step) total cpu time:465.15703201 ms
Epoch Time(s): 6.9039
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2560 | Train Acc 0.9297 | Speed (samples/sec) 45497.8100 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:56:52,981] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:56:53,090] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=3401.3461412308607
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:24.31266149 ms
avg iteration GPU training time:456.69009399 ms
avg iteration (step) total cpu time:495.70242564 ms
Epoch Time(s): 7.1256
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2496 | Train Acc 0.9307 | Speed (samples/sec) 45496.6468 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:00,988] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:01,101] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=3399.334264518307
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:23.79939143 ms
avg iteration GPU training time:453.03196208 ms
avg iteration (step) total cpu time:494.75948016 ms
Epoch Time(s): 7.0434
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2553 | Train Acc 0.9302 | Speed (samples/sec) 45480.1508 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.19044304 ms
avg iteration GPU training time:427.05234782 ms
avg iteration (step) total cpu time:470.42393684 ms
Epoch Time(s): 6.9319
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2520 | Train Acc 0.9308 | Speed (samples/sec) 45493.2534 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:11,995] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:12,107] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=3400.559602547902
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.68350919 ms
avg iteration GPU training time:472.45752970 ms
avg iteration (step) total cpu time:514.85363642 ms
Epoch Time(s): 7.0448
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2516 | Train Acc 0.9297 | Speed (samples/sec) 45488.4019 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:20,108] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:20,222] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=3399.552723802594
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:25.19657580 ms
avg iteration GPU training time:428.74108887 ms
avg iteration (step) total cpu time:472.04685211 ms
Epoch Time(s): 7.0188
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2612 | Train Acc 0.9289 | Speed (samples/sec) 45492.4363 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:27,903] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:28,014] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=3400.491579396851
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:29.91933886 ms
avg iteration GPU training time:433.01014201 ms
avg iteration (step) total cpu time:481.10516866 ms
Epoch Time(s): 6.8621
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2627 | Train Acc 0.9280 | Speed (samples/sec) 45503.7856 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:35,753] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:35,865] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=3401.168585374435
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.17225647 ms
avg iteration GPU training time:434.27774048 ms
avg iteration (step) total cpu time:475.64609845 ms
Epoch Time(s): 6.9064
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2514 | Train Acc 0.9317 | Speed (samples/sec) 45507.8339 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.47340775 ms
avg iteration GPU training time:430.32204183 ms
avg iteration (step) total cpu time:471.70519829 ms
Epoch Time(s): 7.1316
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2505 | Train Acc 0.9302 | Speed (samples/sec) 45509.1463 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:47,479] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:47,591] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=3401.3793314868085
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:24.97270393 ms
avg iteration GPU training time:430.86329142 ms
avg iteration (step) total cpu time:470.68421046 ms
Epoch Time(s): 7.5186
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2571 | Train Acc 0.9272 | Speed (samples/sec) 45505.0619 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:57:55,494] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:57:55,607] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=3402.247991256024
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:27.01455943 ms
avg iteration GPU training time:435.28601074 ms
avg iteration (step) total cpu time:480.04237811 ms
Epoch Time(s): 7.0020
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2605 | Train Acc 0.9272 | Speed (samples/sec) 45512.5464 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:03,451] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:03,564] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=3402.9439707740603
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.31508319 ms
avg iteration GPU training time:421.92089844 ms
avg iteration (step) total cpu time:463.72167269 ms
Epoch Time(s): 6.9673
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2456 | Train Acc 0.9316 | Speed (samples/sec) 45516.0360 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:11,378] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:11,489] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=3403.1922971706513
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:25.83554141 ms
avg iteration GPU training time:424.16975911 ms
avg iteration (step) total cpu time:464.92091815 ms
Epoch Time(s): 6.9671
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2534 | Train Acc 0.9292 | Speed (samples/sec) 45521.8296 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:23.11766434 ms
avg iteration GPU training time:447.67963664 ms
avg iteration (step) total cpu time:488.70237668 ms
Epoch Time(s): 7.0190
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2532 | Train Acc 0.9297 | Speed (samples/sec) 45501.7784 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:22,394] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:22,507] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=3401.637494492172
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:25.70612335 ms
avg iteration GPU training time:448.33808390 ms
avg iteration (step) total cpu time:489.06087875 ms
Epoch Time(s): 6.9874
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2558 | Train Acc 0.9301 | Speed (samples/sec) 45487.2372 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:30,309] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:30,423] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=3400.5150381280973
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:22.97213872 ms
avg iteration GPU training time:427.64443970 ms
avg iteration (step) total cpu time:467.35421817 ms
Epoch Time(s): 6.8455
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2479 | Train Acc 0.9312 | Speed (samples/sec) 45497.8048 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:38,170] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:38,283] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=3400.2319473931348
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.28884252 ms
avg iteration GPU training time:458.91283162 ms
avg iteration (step) total cpu time:502.66027451 ms
Epoch Time(s): 6.9740
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2504 | Train Acc 0.9300 | Speed (samples/sec) 45481.2119 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:46,380] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:46,492] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=3398.620319929218
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:25.19060262 ms
avg iteration GPU training time:444.89139811 ms
avg iteration (step) total cpu time:485.29307048 ms
Epoch Time(s): 7.2145
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2565 | Train Acc 0.9288 | Speed (samples/sec) 45467.3707 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:22.30664508 ms
avg iteration GPU training time:460.80683390 ms
avg iteration (step) total cpu time:501.56013171 ms
Epoch Time(s): 6.9052
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2550 | Train Acc 0.9304 | Speed (samples/sec) 45460.8563 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:58:57,420] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:58:57,531] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=3397.703345795144
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.86654917 ms
avg iteration GPU training time:427.34264119 ms
avg iteration (step) total cpu time:472.61031469 ms
Epoch Time(s): 6.9880
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2435 | Train Acc 0.9322 | Speed (samples/sec) 45462.2553 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:59:05,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:59:05,381] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=3398.800052575392
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:23.54833094 ms
avg iteration GPU training time:457.25250244 ms
avg iteration (step) total cpu time:496.67763710 ms
Epoch Time(s): 6.9272
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2436 | Train Acc 0.9316 | Speed (samples/sec) 45463.2634 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:59:13,329] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:59:13,442] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=3396.918759575172
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:22.60990969 ms
avg iteration GPU training time:450.72685750 ms
avg iteration (step) total cpu time:487.98712095 ms
Epoch Time(s): 7.0711
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2445 | Train Acc 0.9305 | Speed (samples/sec) 45448.6484 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

[2021-06-13 01:59:21,064] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-13 01:59:21,172] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=3397.855526768527
-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.66394679 ms
avg iteration GPU training time:424.75731405 ms
avg iteration (step) total cpu time:469.61394946 ms
Epoch Time(s): 6.8100
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2495 | Train Acc 0.9298 | Speed (samples/sec) 45460.9826 | GPU 28196.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43408203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47314453125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49658203125GB

Max Memory Allocated 27.535395622253418  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.43212890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.47119140625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.535395622253418  GigaBytes

avg iteration(step) data from cpu to GPU time:26.76662445 ms
avg iteration GPU training time:421.58956909 ms
avg iteration (step) total cpu time:467.03235308 ms
Epoch Time(s): 6.7559
Eval Acc 0.9177
Test Acc: 0.7570
Avg epoch time(time.time()): 6942.2222549716635 ms
total avg iteration(step) data from cpu to GPU time:26.33284066 ms
total avg iteration GPU training time:433.89817573 ms
total avg iteration (step) total cpu time:477.06428928 ms
