[2021-06-12 00:45:31,063] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-12 00:45:34,723] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_serial.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-12 00:45:35,700] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-12 00:45:35,700] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-12 00:45:35,700] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-12 00:45:35,700] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-12 00:45:35,700] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623458741.402723
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.03125, 'VmHWM': 1164.171875, 'VmRSS': 1164.171875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6345
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2826
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0714
-------------------------------------------------end of load ogb****************** step Time(s): 0.0021
finish constructing ogbn-products
load ogb-products time total: 1.992199182510376
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9931
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8167
after train_g.create_formats_() step Time(s): 1.7862
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-12 00:45:49,029] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-12 00:45:49,030] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-12 00:45:49,034] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-12 00:45:51,392] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-12 00:45:51,394] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-12 00:45:51,394] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-12 00:45:51,394] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-12 00:45:51,394] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-12 00:45:51,394] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f00de7238d0>
[2021-06-12 00:45:51,394] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:45:51,394] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-12 00:45:51,394] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-12 00:45:51,394] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-12 00:45:51,394] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-12 00:45:51,395] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-12 00:45:51,396] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-12 00:45:51,398] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68603515625GB

Max Memory Allocated 1.2873806953430176  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.74072265625GB

Max Memory Allocated 1.2873806953430176  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3844022750854492  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3844022750854492  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.41019868850708  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.5905 | Train Acc 0.0188 | Speed (samples/sec) nan | GPU 1444.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.41019868850708  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6392498016357422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6392498016357422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6392498016357422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6392498016357422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6404967308044434  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6404967308044434  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6404967308044434  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6404967308044434  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6404967308044434  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

avg iteration(step) data from cpu to GPU time:17.29315784 ms
avg iteration GPU training time:21.64535262 ms
avg iteration (step) total cpu time:204.88975265 ms
Epoch Time(s): 5.4734
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

Epoch 00001 | Step 00000 | Loss 4.1960 | Train Acc 0.0828 | Speed (samples/sec) 164272.7194 | GPU 1680.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6412487030029297  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6412487030029297  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

avg iteration(step) data from cpu to GPU time:15.21400140 ms
avg iteration GPU training time:21.78513163 ms
avg iteration (step) total cpu time:186.06996536 ms
Epoch Time(s): 5.3360
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

Epoch 00002 | Step 00000 | Loss 4.1690 | Train Acc 0.0835 | Speed (samples/sec) 155736.6347 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

avg iteration(step) data from cpu to GPU time:15.29599407 ms
avg iteration GPU training time:21.10575988 ms
avg iteration (step) total cpu time:206.05022257 ms
Epoch Time(s): 5.4854
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

Epoch 00003 | Step 00000 | Loss 3.8946 | Train Acc 0.1132 | Speed (samples/sec) 154066.5051 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

avg iteration(step) data from cpu to GPU time:15.73142407 ms
avg iteration GPU training time:20.69898172 ms
avg iteration (step) total cpu time:177.31421644 ms
Epoch Time(s): 5.0656
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

Epoch 00004 | Step 00000 | Loss 3.4563 | Train Acc 0.1773 | Speed (samples/sec) 162275.4621 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

avg iteration(step) data from cpu to GPU time:15.42108215 ms
avg iteration GPU training time:32.38736014 ms
avg iteration (step) total cpu time:197.61588357 ms
Epoch Time(s): 5.4972
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

Epoch 00005 | Step 00000 | Loss 3.0593 | Train Acc 0.2546 | Speed (samples/sec) 167974.4683 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

avg iteration(step) data from cpu to GPU time:14.81528733 ms
avg iteration GPU training time:20.51837661 ms
avg iteration (step) total cpu time:163.46107830 ms
Epoch Time(s): 4.8275
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.6474 | Train Acc 0.3510 | Speed (samples/sec) 171710.7382 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74311291 ms
avg iteration GPU training time:20.73363495 ms
avg iteration (step) total cpu time:170.55843093 ms
Epoch Time(s): 5.0074
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

Epoch 00007 | Step 00000 | Loss 2.2915 | Train Acc 0.4218 | Speed (samples/sec) 173621.4637 | GPU 1681.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422300338745117  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.27533965 ms
avg iteration GPU training time:21.33857155 ms
avg iteration (step) total cpu time:183.84887955 ms
Epoch Time(s): 5.1088
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00008 | Step 00000 | Loss 2.0269 | Train Acc 0.4712 | Speed (samples/sec) 175883.8214 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:17.58391857 ms
avg iteration GPU training time:20.58271998 ms
avg iteration (step) total cpu time:184.07812986 ms
Epoch Time(s): 5.0967
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.7855 | Train Acc 0.5130 | Speed (samples/sec) 175973.6008 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

[2021-06-12 00:46:43,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-12 00:46:43,159] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=5248.983036317852
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.75018770 ms
avg iteration GPU training time:21.24743826 ms
avg iteration (step) total cpu time:159.84231775 ms
Epoch Time(s): 4.8618
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.6414 | Train Acc 0.5463 | Speed (samples/sec) 178085.6650 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.59511870 ms
avg iteration GPU training time:20.62711837 ms
avg iteration (step) total cpu time:208.81136981 ms
Epoch Time(s): 5.5721
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.5054 | Train Acc 0.5800 | Speed (samples/sec) 180184.2196 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.62073586 ms
avg iteration GPU training time:20.90812492 ms
avg iteration (step) total cpu time:164.59783641 ms
Epoch Time(s): 5.1028
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.3909 | Train Acc 0.6178 | Speed (samples/sec) 181595.7546 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.27645076 ms
avg iteration GPU training time:20.64324067 ms
avg iteration (step) total cpu time:164.35391253 ms
Epoch Time(s): 4.9090
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.2857 | Train Acc 0.6566 | Speed (samples/sec) 182972.4102 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:17.32298764 ms
avg iteration GPU training time:20.53949651 ms
avg iteration (step) total cpu time:182.83247948 ms
Epoch Time(s): 5.4036
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.2149 | Train Acc 0.6817 | Speed (samples/sec) 183402.1896 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:17.04994626 ms
avg iteration GPU training time:20.75273895 ms
avg iteration (step) total cpu time:165.79214009 ms
Epoch Time(s): 4.9397
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.1632 | Train Acc 0.7053 | Speed (samples/sec) 182799.3731 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.50147490 ms
avg iteration GPU training time:20.47442627 ms
avg iteration (step) total cpu time:190.55953893 ms
Epoch Time(s): 5.2685
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00016 | Step 00000 | Loss 1.1025 | Train Acc 0.7247 | Speed (samples/sec) 183414.1883 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.10933833 ms
avg iteration GPU training time:21.55209593 ms
avg iteration (step) total cpu time:167.47591712 ms
Epoch Time(s): 4.9737
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00017 | Step 00000 | Loss 1.0560 | Train Acc 0.7390 | Speed (samples/sec) 183740.9331 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.73616574 ms
avg iteration GPU training time:21.58840145 ms
avg iteration (step) total cpu time:185.80020558 ms
Epoch Time(s): 5.1125
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9750 | Train Acc 0.7512 | Speed (samples/sec) 183368.6169 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.19078983 ms
avg iteration GPU training time:20.94646974 ms
avg iteration (step) total cpu time:219.66988390 ms
Epoch Time(s): 5.4880
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.9496 | Train Acc 0.7644 | Speed (samples/sec) 181821.7167 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

[2021-06-12 00:47:35,037] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:47:35,038] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=5105.0178122627585
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.07223554 ms
avg iteration GPU training time:20.59426048 ms
avg iteration (step) total cpu time:166.52310978 ms
Epoch Time(s): 5.1078
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.9137 | Train Acc 0.7742 | Speed (samples/sec) 182700.4408 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.83879280 ms
avg iteration GPU training time:20.85922293 ms
avg iteration (step) total cpu time:166.55221852 ms
Epoch Time(s): 4.9396
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.9068 | Train Acc 0.7779 | Speed (samples/sec) 182828.4893 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:17.53676527 ms
avg iteration GPU training time:21.02393324 ms
avg iteration (step) total cpu time:210.87412401 ms
Epoch Time(s): 5.4162
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.8857 | Train Acc 0.7914 | Speed (samples/sec) 180265.2807 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.60633304 ms
avg iteration GPU training time:21.52035193 ms
avg iteration (step) total cpu time:170.74615305 ms
Epoch Time(s): 4.9508
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.8490 | Train Acc 0.7936 | Speed (samples/sec) 180351.6255 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.35353609 ms
avg iteration GPU training time:20.35043508 ms
avg iteration (step) total cpu time:204.22974500 ms
Epoch Time(s): 5.3716
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.8177 | Train Acc 0.7998 | Speed (samples/sec) 180988.8388 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:19.31547911 ms
avg iteration GPU training time:21.90336592 ms
avg iteration (step) total cpu time:325.22355426 ms
Epoch Time(s): 6.8902
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.8112 | Train Acc 0.8065 | Speed (samples/sec) 180372.9233 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:17.43041177 ms
avg iteration GPU training time:22.59302382 ms
avg iteration (step) total cpu time:253.53509730 ms
Epoch Time(s): 6.0770
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.7645 | Train Acc 0.8089 | Speed (samples/sec) 178955.9725 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.23728874 ms
avg iteration GPU training time:20.92180356 ms
avg iteration (step) total cpu time:198.37750088 ms
Epoch Time(s): 5.3427
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.7488 | Train Acc 0.8164 | Speed (samples/sec) 179791.6032 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.25810337 ms
avg iteration GPU training time:20.65195066 ms
avg iteration (step) total cpu time:200.95777512 ms
Epoch Time(s): 5.2478
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.7357 | Train Acc 0.8182 | Speed (samples/sec) 180654.2125 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.96616745 ms
avg iteration GPU training time:21.01239846 ms
avg iteration (step) total cpu time:226.99174014 ms
Epoch Time(s): 5.6830
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.7187 | Train Acc 0.8223 | Speed (samples/sec) 181071.1464 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

[2021-06-12 00:48:30,005] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:48:30,005] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=5023.865624728627
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.69543865 ms
avg iteration GPU training time:20.52067774 ms
avg iteration (step) total cpu time:163.86660663 ms
Epoch Time(s): 5.0477
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.7239 | Train Acc 0.8252 | Speed (samples/sec) 181457.0346 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:18.80148654 ms
avg iteration GPU training time:20.97457452 ms
avg iteration (step) total cpu time:172.28076675 ms
Epoch Time(s): 4.9734
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.7061 | Train Acc 0.8287 | Speed (samples/sec) 181289.0650 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.66474195 ms
avg iteration GPU training time:21.20927134 ms
avg iteration (step) total cpu time:191.65793332 ms
Epoch Time(s): 5.2059
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.6838 | Train Acc 0.8324 | Speed (samples/sec) 181462.7346 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63837390 ms
avg iteration GPU training time:20.66983275 ms
avg iteration (step) total cpu time:165.52686691 ms
Epoch Time(s): 4.9748
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.6748 | Train Acc 0.8287 | Speed (samples/sec) 181526.0241 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.52416576 ms
avg iteration GPU training time:20.49762050 ms
avg iteration (step) total cpu time:192.99127839 ms
Epoch Time(s): 5.2344
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.6519 | Train Acc 0.8377 | Speed (samples/sec) 181198.6767 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12973959 ms
avg iteration GPU training time:20.22049436 ms
avg iteration (step) total cpu time:169.40093040 ms
Epoch Time(s): 5.1543
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.6779 | Train Acc 0.8274 | Speed (samples/sec) 181581.6265 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.15853379 ms
avg iteration GPU training time:20.33616864 ms
avg iteration (step) total cpu time:186.87300249 ms
Epoch Time(s): 5.2392
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.6533 | Train Acc 0.8372 | Speed (samples/sec) 181301.0714 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:18.03181371 ms
avg iteration GPU training time:21.34937876 ms
avg iteration (step) total cpu time:307.13787946 ms
Epoch Time(s): 6.9131
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.6657 | Train Acc 0.8327 | Speed (samples/sec) 181070.8626 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:19.56547754 ms
avg iteration GPU training time:23.62776444 ms
avg iteration (step) total cpu time:202.54770192 ms
Epoch Time(s): 5.8783
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.6385 | Train Acc 0.8389 | Speed (samples/sec) 180898.0999 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.27431245 ms
avg iteration GPU training time:20.81285529 ms
avg iteration (step) total cpu time:174.92816665 ms
Epoch Time(s): 4.9511
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.6490 | Train Acc 0.8351 | Speed (samples/sec) 180227.9993 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

[2021-06-12 00:49:23,707] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:49:23,707] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4959.032072940598
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.35239853 ms
avg iteration GPU training time:20.42190534 ms
avg iteration (step) total cpu time:195.36837665 ms
Epoch Time(s): 5.1766
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.6257 | Train Acc 0.8403 | Speed (samples/sec) 180291.5784 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.86983551 ms
avg iteration GPU training time:21.65025156 ms
avg iteration (step) total cpu time:185.49574505 ms
Epoch Time(s): 5.1410
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.6275 | Train Acc 0.8384 | Speed (samples/sec) 180417.9443 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:15.26768286 ms
avg iteration GPU training time:20.35094712 ms
avg iteration (step) total cpu time:179.66634577 ms
Epoch Time(s): 5.1149
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.6128 | Train Acc 0.8455 | Speed (samples/sec) 180244.1158 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

avg iteration(step) data from cpu to GPU time:16.07365253 ms
avg iteration GPU training time:20.48847996 ms
avg iteration (step) total cpu time:185.27447094 ms
Epoch Time(s): 5.1942
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.6248 | Train Acc 0.8405 | Speed (samples/sec) 180551.9903 | GPU 1683.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6437745094299316  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:14.88173684 ms
avg iteration GPU training time:22.25357957 ms
avg iteration (step) total cpu time:191.49405306 ms
Epoch Time(s): 5.2645
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.5811 | Train Acc 0.8532 | Speed (samples/sec) 180728.0643 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:15.01631130 ms
avg iteration GPU training time:20.63053079 ms
avg iteration (step) total cpu time:197.85321843 ms
Epoch Time(s): 5.3853
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.6046 | Train Acc 0.8487 | Speed (samples/sec) 181164.8795 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:15.71632871 ms
avg iteration GPU training time:21.21752149 ms
avg iteration (step) total cpu time:202.44362138 ms
Epoch Time(s): 5.3259
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.5830 | Train Acc 0.8443 | Speed (samples/sec) 180646.1545 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:14.71266616 ms
avg iteration GPU training time:20.42688855 ms
avg iteration (step) total cpu time:168.09792952 ms
Epoch Time(s): 4.9274
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.6207 | Train Acc 0.8443 | Speed (samples/sec) 181037.1718 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63512733 ms
avg iteration GPU training time:20.96731637 ms
avg iteration (step) total cpu time:188.23534792 ms
Epoch Time(s): 5.2420
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.5918 | Train Acc 0.8502 | Speed (samples/sec) 181454.9262 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:15.78238548 ms
avg iteration GPU training time:20.83852508 ms
avg iteration (step) total cpu time:197.30533253 ms
Epoch Time(s): 5.2696
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.5796 | Train Acc 0.8517 | Speed (samples/sec) 181744.9303 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

[2021-06-12 00:50:15,412] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:50:15,412] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4961.344949336975
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31429802 ms
avg iteration GPU training time:23.22569310 ms
avg iteration (step) total cpu time:165.75401480 ms
Epoch Time(s): 4.8399
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.5897 | Train Acc 0.8501 | Speed (samples/sec) 181772.8356 | GPU 1683.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6441197395324707  GigaBytes

avg iteration(step) data from cpu to GPU time:14.24229821 ms
avg iteration GPU training time:20.56241729 ms
avg iteration (step) total cpu time:252.31994282 ms
Epoch Time(s): 6.3140
Eval Acc 0.8571
Test Acc: 0.6818
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.5813 | Train Acc 0.8492 | Speed (samples/sec) 182298.8991 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.54485815 ms
avg iteration GPU training time:20.99426304 ms
avg iteration (step) total cpu time:159.19351578 ms
Epoch Time(s): 4.8010
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.5926 | Train Acc 0.8478 | Speed (samples/sec) 182396.2024 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.83973512 ms
avg iteration GPU training time:20.80063126 ms
avg iteration (step) total cpu time:173.66144874 ms
Epoch Time(s): 5.0481
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.5756 | Train Acc 0.8519 | Speed (samples/sec) 182286.3266 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.06104140 ms
avg iteration GPU training time:20.44237397 ms
avg iteration (step) total cpu time:186.01233309 ms
Epoch Time(s): 5.2665
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.5682 | Train Acc 0.8525 | Speed (samples/sec) 182665.3431 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82470105 ms
avg iteration GPU training time:21.37143014 ms
avg iteration (step) total cpu time:178.10951580 ms
Epoch Time(s): 5.1165
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.5561 | Train Acc 0.8578 | Speed (samples/sec) 182641.5685 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.33735258 ms
avg iteration GPU training time:21.02466340 ms
avg iteration (step) total cpu time:230.63451594 ms
Epoch Time(s): 6.1933
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.5821 | Train Acc 0.8477 | Speed (samples/sec) 182976.4564 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:18.59682655 ms
avg iteration GPU training time:20.87008580 ms
avg iteration (step) total cpu time:210.09622921 ms
Epoch Time(s): 5.6582
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.5854 | Train Acc 0.8472 | Speed (samples/sec) 183012.0453 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.68667325 ms
avg iteration GPU training time:20.06998409 ms
avg iteration (step) total cpu time:174.30279472 ms
Epoch Time(s): 5.0418
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.5498 | Train Acc 0.8593 | Speed (samples/sec) 183135.4738 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.56157667 ms
avg iteration GPU training time:20.31188930 ms
avg iteration (step) total cpu time:166.83363914 ms
Epoch Time(s): 4.9088
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.5554 | Train Acc 0.8530 | Speed (samples/sec) 183020.9047 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

[2021-06-12 00:51:42,617] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:51:42,618] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4977.148945156675
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.21276517 ms
avg iteration GPU training time:21.34461958 ms
avg iteration (step) total cpu time:206.06171001 ms
Epoch Time(s): 5.3304
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.5531 | Train Acc 0.8586 | Speed (samples/sec) 183115.2293 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.82190826 ms
avg iteration GPU training time:21.03535982 ms
avg iteration (step) total cpu time:162.53235123 ms
Epoch Time(s): 4.9443
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.5466 | Train Acc 0.8614 | Speed (samples/sec) 183311.6254 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.78770915 ms
avg iteration GPU training time:20.56879130 ms
avg iteration (step) total cpu time:166.87690128 ms
Epoch Time(s): 5.0094
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.5824 | Train Acc 0.8480 | Speed (samples/sec) 183520.3060 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.33618025 ms
avg iteration GPU training time:21.34300752 ms
avg iteration (step) total cpu time:207.24972812 ms
Epoch Time(s): 5.4446
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.5494 | Train Acc 0.8569 | Speed (samples/sec) 183187.5302 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.13884804 ms
avg iteration GPU training time:23.42409325 ms
avg iteration (step) total cpu time:184.02433395 ms
Epoch Time(s): 5.1716
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.5430 | Train Acc 0.8606 | Speed (samples/sec) 182934.4494 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.80498331 ms
avg iteration GPU training time:20.16955046 ms
avg iteration (step) total cpu time:208.17249471 ms
Epoch Time(s): 5.3847
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.5545 | Train Acc 0.8536 | Speed (samples/sec) 182858.9745 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.58419791 ms
avg iteration GPU training time:20.58712734 ms
avg iteration (step) total cpu time:204.72858169 ms
Epoch Time(s): 5.4347
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.5595 | Train Acc 0.8537 | Speed (samples/sec) 182876.3869 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.62827917 ms
avg iteration GPU training time:20.38579525 ms
avg iteration (step) total cpu time:182.63595754 ms
Epoch Time(s): 5.1880
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.5365 | Train Acc 0.8604 | Speed (samples/sec) 182965.0116 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.68416561 ms
avg iteration GPU training time:20.78907637 ms
avg iteration (step) total cpu time:195.22291964 ms
Epoch Time(s): 5.2447
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.5502 | Train Acc 0.8588 | Speed (samples/sec) 182759.9658 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.48621403 ms
avg iteration GPU training time:20.43874619 ms
avg iteration (step) total cpu time:201.19352774 ms
Epoch Time(s): 5.2731
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.5457 | Train Acc 0.8574 | Speed (samples/sec) 182956.1049 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

[2021-06-12 00:52:34,722] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:52:34,722] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=4963.657938736193
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.85505460 ms
avg iteration GPU training time:20.66829092 ms
avg iteration (step) total cpu time:172.32344367 ms
Epoch Time(s): 5.0083
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.5606 | Train Acc 0.8535 | Speed (samples/sec) 183035.3034 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.25611071 ms
avg iteration GPU training time:20.11771323 ms
avg iteration (step) total cpu time:196.25960697 ms
Epoch Time(s): 5.1953
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.5604 | Train Acc 0.8529 | Speed (samples/sec) 183151.6027 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.11507771 ms
avg iteration GPU training time:20.88663275 ms
avg iteration (step) total cpu time:186.06638908 ms
Epoch Time(s): 5.2137
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.5403 | Train Acc 0.8603 | Speed (samples/sec) 183081.6432 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:19.81677081 ms
avg iteration GPU training time:21.15657304 ms
avg iteration (step) total cpu time:186.27704274 ms
Epoch Time(s): 5.1569
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.5402 | Train Acc 0.8584 | Speed (samples/sec) 183061.2230 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.75440277 ms
avg iteration GPU training time:20.69614549 ms
avg iteration (step) total cpu time:201.09044422 ms
Epoch Time(s): 5.2377
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.5373 | Train Acc 0.8600 | Speed (samples/sec) 182717.6528 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.77315200 ms
avg iteration GPU training time:21.09360296 ms
avg iteration (step) total cpu time:213.17885139 ms
Epoch Time(s): 5.5477
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.5260 | Train Acc 0.8589 | Speed (samples/sec) 182857.6872 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.32924791 ms
avg iteration GPU training time:23.53756783 ms
avg iteration (step) total cpu time:190.76475230 ms
Epoch Time(s): 5.3150
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.5340 | Train Acc 0.8552 | Speed (samples/sec) 182939.5767 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:14.86207121 ms
avg iteration GPU training time:20.83449867 ms
avg iteration (step) total cpu time:187.17152422 ms
Epoch Time(s): 5.1738
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.5276 | Train Acc 0.8596 | Speed (samples/sec) 183025.2426 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.86527122 ms
avg iteration GPU training time:20.93582240 ms
avg iteration (step) total cpu time:195.84126906 ms
Epoch Time(s): 5.2803
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.5474 | Train Acc 0.8593 | Speed (samples/sec) 182619.8925 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:18.60541110 ms
avg iteration GPU training time:22.00642603 ms
avg iteration (step) total cpu time:196.28110799 ms
Epoch Time(s): 5.2462
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.5512 | Train Acc 0.8571 | Speed (samples/sec) 182524.2449 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

[2021-06-12 00:53:27,180] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:53:27,180] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=4969.616152021168
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.78238236 ms
avg iteration GPU training time:20.59792311 ms
avg iteration (step) total cpu time:181.08367920 ms
Epoch Time(s): 5.0906
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.5253 | Train Acc 0.8604 | Speed (samples/sec) 182484.0029 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.21015280 ms
avg iteration GPU training time:21.13654969 ms
avg iteration (step) total cpu time:201.77808675 ms
Epoch Time(s): 5.3458
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.5243 | Train Acc 0.8633 | Speed (samples/sec) 182417.7909 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.95617164 ms
avg iteration GPU training time:20.48237332 ms
avg iteration (step) total cpu time:178.78606103 ms
Epoch Time(s): 5.1878
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.5357 | Train Acc 0.8614 | Speed (samples/sec) 182471.3074 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.60908820 ms
avg iteration GPU training time:20.83814118 ms
avg iteration (step) total cpu time:163.90189258 ms
Epoch Time(s): 4.9827
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.5332 | Train Acc 0.8605 | Speed (samples/sec) 182588.9883 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:19.69133646 ms
avg iteration GPU training time:21.83495261 ms
avg iteration (step) total cpu time:317.22562963 ms
Epoch Time(s): 6.9440
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.5348 | Train Acc 0.8586 | Speed (samples/sec) 182103.3206 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:18.84878817 ms
avg iteration GPU training time:22.35655264 ms
avg iteration (step) total cpu time:226.41955722 ms
Epoch Time(s): 6.0703
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.5207 | Train Acc 0.8670 | Speed (samples/sec) 181511.6480 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.62709834 ms
avg iteration GPU training time:21.20865163 ms
avg iteration (step) total cpu time:214.37241814 ms
Epoch Time(s): 5.7060
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.5101 | Train Acc 0.8659 | Speed (samples/sec) 181706.1359 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.20662394 ms
avg iteration GPU training time:21.60415996 ms
avg iteration (step) total cpu time:203.04586671 ms
Epoch Time(s): 5.1724
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.5110 | Train Acc 0.8648 | Speed (samples/sec) 181740.5038 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.65194745 ms
avg iteration GPU training time:20.92606579 ms
avg iteration (step) total cpu time:178.02221125 ms
Epoch Time(s): 5.1528
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.5319 | Train Acc 0.8610 | Speed (samples/sec) 181831.8370 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.61906017 ms
avg iteration GPU training time:21.25157807 ms
avg iteration (step) total cpu time:190.36022100 ms
Epoch Time(s): 5.1641
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.5417 | Train Acc 0.8587 | Speed (samples/sec) 181805.4566 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

[2021-06-12 00:54:23,955] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:54:23,955] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=4965.286000095387
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.79108351 ms
avg iteration GPU training time:21.17181951 ms
avg iteration (step) total cpu time:331.78366314 ms
Epoch Time(s): 7.0482
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.5325 | Train Acc 0.8630 | Speed (samples/sec) 181705.7507 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74667055 ms
avg iteration GPU training time:20.86286562 ms
avg iteration (step) total cpu time:185.50640886 ms
Epoch Time(s): 5.3149
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.5376 | Train Acc 0.8577 | Speed (samples/sec) 181661.0036 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.45113902 ms
avg iteration GPU training time:21.16570507 ms
avg iteration (step) total cpu time:229.55025326 ms
Epoch Time(s): 5.6662
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.5113 | Train Acc 0.8648 | Speed (samples/sec) 181605.4550 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.78163208 ms
avg iteration GPU training time:20.33450161 ms
avg iteration (step) total cpu time:177.04714428 ms
Epoch Time(s): 5.3881
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.5032 | Train Acc 0.8656 | Speed (samples/sec) 181730.1381 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.53168878 ms
avg iteration GPU training time:20.79689893 ms
avg iteration (step) total cpu time:183.95790187 ms
Epoch Time(s): 5.3063
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5283 | Train Acc 0.8582 | Speed (samples/sec) 181571.7528 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.13540649 ms
avg iteration GPU training time:21.16668216 ms
avg iteration (step) total cpu time:179.83280529 ms
Epoch Time(s): 5.1697
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.5038 | Train Acc 0.8654 | Speed (samples/sec) 181612.7045 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.30530037 ms
avg iteration GPU training time:21.10483759 ms
avg iteration (step) total cpu time:194.33695620 ms
Epoch Time(s): 5.3787
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5243 | Train Acc 0.8605 | Speed (samples/sec) 181687.8254 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.71824273 ms
avg iteration GPU training time:21.60360440 ms
avg iteration (step) total cpu time:162.30251572 ms
Epoch Time(s): 5.0398
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5067 | Train Acc 0.8649 | Speed (samples/sec) 181703.6627 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:16.98651929 ms
avg iteration GPU training time:20.45729464 ms
avg iteration (step) total cpu time:192.96164946 ms
Epoch Time(s): 5.2915
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5233 | Train Acc 0.8614 | Speed (samples/sec) 181536.9135 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.46623395 ms
avg iteration GPU training time:21.08617644 ms
avg iteration (step) total cpu time:208.61892267 ms
Epoch Time(s): 5.5516
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5048 | Train Acc 0.8639 | Speed (samples/sec) 181389.2664 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

[2021-06-12 00:55:17,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-12 00:55:17,158] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=4989.708633233024
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:15.61611930 ms
avg iteration GPU training time:23.24266208 ms
avg iteration (step) total cpu time:162.00819882 ms
Epoch Time(s): 5.0956
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5258 | Train Acc 0.8631 | Speed (samples/sec) 181492.7296 | GPU 2036.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9883332252502441  GigaBytes

avg iteration(step) data from cpu to GPU time:17.74152149 ms
avg iteration GPU training time:21.35366128 ms
avg iteration (step) total cpu time:181.57466975 ms
Epoch Time(s): 5.2284
Eval Acc 0.8717
Test Acc: 0.6943
Avg epoch time(time.time()): 5318.7185277541475 ms
total avg iteration(step) data from cpu to GPU time:16.36767550 ms
total avg iteration GPU training time:21.18066633 ms
total avg iteration (step) total cpu time:194.17253815 ms
