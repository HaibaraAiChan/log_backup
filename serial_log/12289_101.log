[2021-06-10 07:19:52,557] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-10 07:19:56,281] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 train_serial.py --batch-size 12289 --deepspeed_config ds_config.json
[2021-06-10 07:19:57,230] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-10 07:19:57,230] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-10 07:19:57,230] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-10 07:19:57,230] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-10 07:19:57,230] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623309602.8086007
before load_ogb step Time(s): 0.0020
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20521.1796875, 'VmSize': 20395.03515625, 'VmHWM': 1165.32421875, 'VmRSS': 1165.32421875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6305
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2838
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0000
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0838
-------------------------------------------------end of load ogb****************** step Time(s): 0.0622
finish constructing ogbn-products
load ogb-products time total: 2.061866521835327
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0628
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8310
after train_g.create_formats_() step Time(s): 1.7548
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-10 07:20:10,489] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.3.17+unknown, git-hash=unknown, git-branch=unknown
[2021-06-10 07:20:10,490] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-10 07:20:10,494] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-10 07:20:12,871] [INFO] [engine.py:165:__init__] DeepSpeed Flops Profiler Enabled: False
[2021-06-10 07:20:12,873] [INFO] [engine.py:622:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-10 07:20:12,873] [INFO] [engine.py:626:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-10 07:20:12,873] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-10 07:20:12,873] [INFO] [engine.py:450:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-10 07:20:12,874] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fd4db29c8d0>
[2021-06-10 07:20:12,874] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:20:12,874] [INFO] [config.py:748:print] DeepSpeedEngine configuration:
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   allreduce_always_fp32 ........ False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   amp_enabled .................. False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   amp_params ................... False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   checkpoint_tag_validation_enabled  True
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   checkpoint_tag_validation_fail  False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   disable_allgather ............ False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   dump_state ................... False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   dynamic_loss_scale_args ...... None
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   elasticity_enabled ........... False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   fp16_enabled ................. False
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   global_rank .................. 0
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   gradient_accumulation_steps .. 1
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   gradient_clipping ............ 0.0
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   gradient_predivide_factor .... 1.0
[2021-06-10 07:20:12,874] [INFO] [config.py:752:print]   initial_dynamic_scale ........ 4294967296
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   loss_scale ................... 0
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   memory_breakdown ............. False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   optimizer_legacy_fusion ...... False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   optimizer_name ............... adam
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   pld_enabled .................. False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   pld_params ................... False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   prescale_gradients ........... False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   scheduler_name ............... WarmupLR
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   sparse_attention ............. None
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   sparse_gradients_enabled ..... False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   steps_per_print .............. 10
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   tensorboard_enabled .......... False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   tensorboard_output_path ...... 
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   train_batch_size ............. 1500
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   train_micro_batch_size_per_gpu  1500
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   wall_clock_breakdown ......... False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   world_size ................... 1
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   zero_allow_untested_optimizer  False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": false, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true
}
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   zero_enabled ................. False
[2021-06-10 07:20:12,875] [INFO] [config.py:752:print]   zero_optimization_stage ...... 0
[2021-06-10 07:20:12,877] [INFO] [config.py:760:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9306011199951172  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68603515625GB

Max Memory Allocated 1.2872271537780762  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.74072265625GB

Max Memory Allocated 1.2872271537780762  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3842201232910156  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.03955078125GB

Max Memory Allocated 1.3842201232910156  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4100384712219238  GigaBytes

Epoch 00000 | Step 00000 | Loss 5.6103 | Train Acc 0.0198 | Speed (samples/sec) nan | GPU 1443.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.18994140625GB

Max Memory Allocated 1.4100384712219238  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51806640625GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639094352722168  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.54150390625GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.56298828125GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.58837890625GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.51611328125GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.639094352722168  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.53955078125GB

Max Memory Allocated 1.639094352722168  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6399240493774414  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6399240493774414  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6399240493774414  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6399240493774414  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6399240493774414  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6399240493774414  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91650390625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

avg iteration(step) data from cpu to GPU time:16.31876365 ms
avg iteration GPU training time:21.94800880 ms
avg iteration (step) total cpu time:259.24574245 ms
Epoch Time(s): 6.0580
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

Epoch 00001 | Step 00000 | Loss 4.2055 | Train Acc 0.0825 | Speed (samples/sec) 188234.8811 | GPU 1681.3 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86767578125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 3.89111328125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 3.91455078125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 3.93994140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 3.86962890625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 3.89306640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6419248580932617  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6419248580932617  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.05815870 ms
avg iteration GPU training time:21.48392729 ms
avg iteration (step) total cpu time:187.86371838 ms
Epoch Time(s): 5.5884
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

Epoch 00002 | Step 00000 | Loss 4.1624 | Train Acc 0.0821 | Speed (samples/sec) 165327.8455 | GPU 1681.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.17337894 ms
avg iteration GPU training time:21.50498616 ms
avg iteration (step) total cpu time:160.59067033 ms
Epoch Time(s): 4.8647
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

Epoch 00003 | Step 00000 | Loss 3.8980 | Train Acc 0.1134 | Speed (samples/sec) 172199.7443 | GPU 1681.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.12049762 ms
avg iteration GPU training time:22.43224421 ms
avg iteration (step) total cpu time:194.59306110 ms
Epoch Time(s): 5.2164
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

Epoch 00004 | Step 00000 | Loss 3.4526 | Train Acc 0.1762 | Speed (samples/sec) 175990.0357 | GPU 1681.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.80720875 ms
avg iteration GPU training time:22.48455273 ms
avg iteration (step) total cpu time:221.49281068 ms
Epoch Time(s): 5.4712
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

Epoch 00005 | Step 00000 | Loss 3.0570 | Train Acc 0.2595 | Speed (samples/sec) 167840.9081 | GPU 1681.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.18335420 ms
avg iteration GPU training time:21.15619781 ms
avg iteration (step) total cpu time:162.80976209 ms
Epoch Time(s): 4.9798
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.6355 | Train Acc 0.3492 | Speed (samples/sec) 170924.7056 | GPU 1681.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.09855739 ms
avg iteration GPU training time:20.68457898 ms
avg iteration (step) total cpu time:171.61568728 ms
Epoch Time(s): 4.9013
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

Epoch 00007 | Step 00000 | Loss 2.2873 | Train Acc 0.4189 | Speed (samples/sec) 171615.2515 | GPU 1681.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.6422581672668457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.56571934 ms
avg iteration GPU training time:20.99406260 ms
avg iteration (step) total cpu time:186.91789020 ms
Epoch Time(s): 5.1154
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00008 | Step 00000 | Loss 2.0329 | Train Acc 0.4729 | Speed (samples/sec) 171609.6157 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.13746322 ms
avg iteration GPU training time:21.14958798 ms
avg iteration (step) total cpu time:172.11718993 ms
Epoch Time(s): 5.1892
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.7880 | Train Acc 0.5145 | Speed (samples/sec) 175450.0509 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

[2021-06-10 07:21:05,392] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-10 07:21:05,392] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4911.79292332672
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12756374 ms
avg iteration GPU training time:20.48368263 ms
avg iteration (step) total cpu time:175.06926710 ms
Epoch Time(s): 5.1293
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.6408 | Train Acc 0.5434 | Speed (samples/sec) 177920.7461 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74332515 ms
avg iteration GPU training time:20.83274477 ms
avg iteration (step) total cpu time:198.27491587 ms
Epoch Time(s): 5.2929
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.5016 | Train Acc 0.5814 | Speed (samples/sec) 178846.4003 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.62268500 ms
avg iteration GPU training time:21.45064146 ms
avg iteration (step) total cpu time:171.57613147 ms
Epoch Time(s): 5.0194
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.3859 | Train Acc 0.6212 | Speed (samples/sec) 179974.4437 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.26521596 ms
avg iteration GPU training time:21.65382108 ms
avg iteration (step) total cpu time:192.64828075 ms
Epoch Time(s): 5.3110
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.2829 | Train Acc 0.6580 | Speed (samples/sec) 181303.9438 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.20355788 ms
avg iteration GPU training time:20.29146749 ms
avg iteration (step) total cpu time:180.04302545 ms
Epoch Time(s): 5.1744
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.2165 | Train Acc 0.6826 | Speed (samples/sec) 182076.0095 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.10646092 ms
avg iteration GPU training time:20.80692361 ms
avg iteration (step) total cpu time:159.72625126 ms
Epoch Time(s): 4.8761
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.1651 | Train Acc 0.7046 | Speed (samples/sec) 182292.5015 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.18700799 ms
avg iteration GPU training time:20.85108653 ms
avg iteration (step) total cpu time:186.43721667 ms
Epoch Time(s): 5.1066
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00016 | Step 00000 | Loss 1.1091 | Train Acc 0.7254 | Speed (samples/sec) 182893.1297 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95275645 ms
avg iteration GPU training time:21.80395334 ms
avg iteration (step) total cpu time:216.99775349 ms
Epoch Time(s): 5.5447
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00017 | Step 00000 | Loss 1.0594 | Train Acc 0.7372 | Speed (samples/sec) 179426.6473 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.34361874 ms
avg iteration GPU training time:21.01003612 ms
avg iteration (step) total cpu time:163.46480630 ms
Epoch Time(s): 5.0178
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9728 | Train Acc 0.7550 | Speed (samples/sec) 180310.8035 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.04852650 ms
avg iteration GPU training time:21.40809597 ms
avg iteration (step) total cpu time:179.58047173 ms
Epoch Time(s): 5.0697
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.9492 | Train Acc 0.7626 | Speed (samples/sec) 180205.6346 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

[2021-06-10 07:21:57,028] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:21:57,028] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4976.99706551701
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.52427344 ms
avg iteration GPU training time:21.37899069 ms
avg iteration (step) total cpu time:199.25199855 ms
Epoch Time(s): 5.2229
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.9127 | Train Acc 0.7769 | Speed (samples/sec) 179320.7145 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.74054397 ms
avg iteration GPU training time:20.61296290 ms
avg iteration (step) total cpu time:162.35082800 ms
Epoch Time(s): 5.0522
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.9110 | Train Acc 0.7782 | Speed (samples/sec) 180295.4717 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.21270119 ms
avg iteration GPU training time:21.00210901 ms
avg iteration (step) total cpu time:186.57385219 ms
Epoch Time(s): 5.1622
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.8848 | Train Acc 0.7888 | Speed (samples/sec) 181103.4399 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.56991699 ms
avg iteration GPU training time:21.19265747 ms
avg iteration (step) total cpu time:209.54773643 ms
Epoch Time(s): 5.3646
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.8405 | Train Acc 0.7941 | Speed (samples/sec) 179904.6258 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:18.46463125 ms
avg iteration GPU training time:20.40331650 ms
avg iteration (step) total cpu time:162.56403923 ms
Epoch Time(s): 5.0290
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.8149 | Train Acc 0.7986 | Speed (samples/sec) 180602.2540 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:18.04701077 ms
avg iteration GPU training time:20.77538334 ms
avg iteration (step) total cpu time:170.57947679 ms
Epoch Time(s): 4.9837
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.8053 | Train Acc 0.8056 | Speed (samples/sec) 180804.8982 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.24100390 ms
avg iteration GPU training time:20.97103136 ms
avg iteration (step) total cpu time:259.35602188 ms
Epoch Time(s): 6.9310
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.7662 | Train Acc 0.8098 | Speed (samples/sec) 179141.6434 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.44749641 ms
avg iteration GPU training time:21.01315516 ms
avg iteration (step) total cpu time:166.05537588 ms
Epoch Time(s): 5.0551
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.7491 | Train Acc 0.8180 | Speed (samples/sec) 179362.4542 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.90928000 ms
avg iteration GPU training time:20.42274024 ms
avg iteration (step) total cpu time:180.76710268 ms
Epoch Time(s): 5.0252
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.7427 | Train Acc 0.8166 | Speed (samples/sec) 179643.1777 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.94297010 ms
avg iteration GPU training time:21.02543432 ms
avg iteration (step) total cpu time:300.17282746 ms
Epoch Time(s): 6.3918
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.7196 | Train Acc 0.8215 | Speed (samples/sec) 179143.6557 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

[2021-06-10 07:22:51,138] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:22:51,138] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=5010.347106665148
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.02247854 ms
avg iteration GPU training time:21.07440550 ms
avg iteration (step) total cpu time:163.97448020 ms
Epoch Time(s): 5.1146
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.7258 | Train Acc 0.8189 | Speed (samples/sec) 179297.1752 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.27753899 ms
avg iteration GPU training time:21.63724206 ms
avg iteration (step) total cpu time:185.73115089 ms
Epoch Time(s): 5.1053
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.7090 | Train Acc 0.8266 | Speed (samples/sec) 179211.7089 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.50099217 ms
avg iteration GPU training time:20.96789811 ms
avg iteration (step) total cpu time:189.85817649 ms
Epoch Time(s): 5.1788
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.6884 | Train Acc 0.8281 | Speed (samples/sec) 179663.8796 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:17.30400285 ms
avg iteration GPU training time:21.63411505 ms
avg iteration (step) total cpu time:160.38855639 ms
Epoch Time(s): 4.9711
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.6741 | Train Acc 0.8266 | Speed (samples/sec) 180046.9896 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.61193319 ms
avg iteration GPU training time:20.41698040 ms
avg iteration (step) total cpu time:175.27892373 ms
Epoch Time(s): 5.0226
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.6521 | Train Acc 0.8336 | Speed (samples/sec) 180226.0692 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.69544419 ms
avg iteration GPU training time:20.56826765 ms
avg iteration (step) total cpu time:195.54385272 ms
Epoch Time(s): 5.2909
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.6751 | Train Acc 0.8290 | Speed (samples/sec) 180598.7628 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.25048828125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.21728515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.78782558 ms
avg iteration GPU training time:20.61371058 ms
avg iteration (step) total cpu time:159.99054909 ms
Epoch Time(s): 4.9193
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.6534 | Train Acc 0.8362 | Speed (samples/sec) 181060.5306 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.31259060 ms
avg iteration GPU training time:20.59771919 ms
avg iteration (step) total cpu time:189.18551098 ms
Epoch Time(s): 5.2677
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.6634 | Train Acc 0.8314 | Speed (samples/sec) 181689.3499 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.50569907 ms
avg iteration GPU training time:21.63733812 ms
avg iteration (step) total cpu time:195.45912743 ms
Epoch Time(s): 5.1768
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.6427 | Train Acc 0.8391 | Speed (samples/sec) 181181.0661 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.28857318 ms
avg iteration GPU training time:21.71414115 ms
avg iteration (step) total cpu time:164.93968530 ms
Epoch Time(s): 5.9371
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.6549 | Train Acc 0.8364 | Speed (samples/sec) 181485.2623 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24853515625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

[2021-06-10 07:23:42,933] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:23:42,934] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4997.013876808158
-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.50251640 ms
avg iteration GPU training time:21.32794502 ms
avg iteration (step) total cpu time:166.86851328 ms
Epoch Time(s): 4.9250
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.6354 | Train Acc 0.8377 | Speed (samples/sec) 181656.7127 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92497756 ms
avg iteration GPU training time:21.52478530 ms
avg iteration (step) total cpu time:216.18526632 ms
Epoch Time(s): 5.5318
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.6305 | Train Acc 0.8414 | Speed (samples/sec) 182094.9284 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:15.69918268 ms
avg iteration GPU training time:23.13859489 ms
avg iteration (step) total cpu time:162.33585098 ms
Epoch Time(s): 5.0531
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.6190 | Train Acc 0.8448 | Speed (samples/sec) 182439.4527 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.27001953125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29541015625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

avg iteration(step) data from cpu to GPU time:16.97153776 ms
avg iteration GPU training time:20.84495128 ms
avg iteration (step) total cpu time:185.83159013 ms
Epoch Time(s): 5.1022
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.6198 | Train Acc 0.8423 | Speed (samples/sec) 182684.7536 | GPU 1682.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22314453125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.24658203125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.26806640625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.29345703125GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.22119140625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.24462890625GB

Max Memory Allocated 1.643040657043457  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:18.53354194 ms
avg iteration GPU training time:21.51133953 ms
avg iteration (step) total cpu time:192.03849272 ms
Epoch Time(s): 6.9205
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.5757 | Train Acc 0.8534 | Speed (samples/sec) 182706.6623 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:19.27645371 ms
avg iteration GPU training time:21.65415868 ms
avg iteration (step) total cpu time:204.22595198 ms
Epoch Time(s): 5.4299
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.6076 | Train Acc 0.8460 | Speed (samples/sec) 181278.1716 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:17.91711703 ms
avg iteration GPU training time:21.93821994 ms
avg iteration (step) total cpu time:207.90178126 ms
Epoch Time(s): 5.4879
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.5911 | Train Acc 0.8465 | Speed (samples/sec) 180549.1071 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12485825 ms
avg iteration GPU training time:21.62184733 ms
avg iteration (step) total cpu time:231.94462603 ms
Epoch Time(s): 5.6306
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.6146 | Train Acc 0.8474 | Speed (samples/sec) 178968.4029 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:16.24363630 ms
avg iteration GPU training time:20.74725827 ms
avg iteration (step) total cpu time:166.36547175 ms
Epoch Time(s): 5.0712
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.5977 | Train Acc 0.8506 | Speed (samples/sec) 179243.7735 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:16.45729178 ms
avg iteration GPU training time:21.27802467 ms
avg iteration (step) total cpu time:219.58808465 ms
Epoch Time(s): 6.0196
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.5896 | Train Acc 0.8520 | Speed (samples/sec) 179562.5367 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

[2021-06-10 07:24:38,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:24:38,556] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=5005.387568534669
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:17.34208298 ms
avg iteration GPU training time:20.85406563 ms
avg iteration (step) total cpu time:214.53246203 ms
Epoch Time(s): 5.3745
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.5934 | Train Acc 0.8491 | Speed (samples/sec) 179759.4525 | GPU 1683.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.6439809799194336  GigaBytes

avg iteration(step) data from cpu to GPU time:17.23100229 ms
avg iteration GPU training time:20.90093370 ms
avg iteration (step) total cpu time:165.40083018 ms
Epoch Time(s): 4.9949
Eval Acc 0.8571
Test Acc: 0.6821
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.5811 | Train Acc 0.8486 | Speed (samples/sec) 179755.3554 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.80632149 ms
avg iteration GPU training time:21.68570761 ms
avg iteration (step) total cpu time:249.74378673 ms
Epoch Time(s): 6.3840
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.5949 | Train Acc 0.8464 | Speed (samples/sec) 179560.9321 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.84311546 ms
avg iteration GPU training time:20.60724935 ms
avg iteration (step) total cpu time:192.46051528 ms
Epoch Time(s): 5.2095
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.5780 | Train Acc 0.8504 | Speed (samples/sec) 179593.5648 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.55346914 ms
avg iteration GPU training time:21.29249469 ms
avg iteration (step) total cpu time:215.87428180 ms
Epoch Time(s): 5.4324
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.5675 | Train Acc 0.8539 | Speed (samples/sec) 179295.1732 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:17.89308782 ms
avg iteration GPU training time:20.77290448 ms
avg iteration (step) total cpu time:175.55048249 ms
Epoch Time(s): 5.1425
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.5681 | Train Acc 0.8555 | Speed (samples/sec) 179492.5284 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82388939 ms
avg iteration GPU training time:20.85379496 ms
avg iteration (step) total cpu time:163.16364028 ms
Epoch Time(s): 4.9425
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.5849 | Train Acc 0.8483 | Speed (samples/sec) 179747.0344 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.12132948 ms
avg iteration GPU training time:21.01123740 ms
avg iteration (step) total cpu time:190.73289091 ms
Epoch Time(s): 5.2304
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.5789 | Train Acc 0.8506 | Speed (samples/sec) 179399.4393 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:18.15998546 ms
avg iteration GPU training time:22.76865439 ms
avg iteration (step) total cpu time:180.41183732 ms
Epoch Time(s): 5.0436
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.5547 | Train Acc 0.8591 | Speed (samples/sec) 179250.1279 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.73374826 ms
avg iteration GPU training time:21.44743555 ms
avg iteration (step) total cpu time:166.31809148 ms
Epoch Time(s): 4.9867
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.5535 | Train Acc 0.8532 | Speed (samples/sec) 179283.3053 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

[2021-06-10 07:26:05,811] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:26:05,811] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=5012.149100786222
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06773541 ms
avg iteration GPU training time:20.67895265 ms
avg iteration (step) total cpu time:181.51350455 ms
Epoch Time(s): 5.1529
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.5468 | Train Acc 0.8555 | Speed (samples/sec) 179527.8089 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:19.28053804 ms
avg iteration GPU training time:21.10306896 ms
avg iteration (step) total cpu time:167.41737452 ms
Epoch Time(s): 5.0111
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.5463 | Train Acc 0.8606 | Speed (samples/sec) 179623.6654 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.24826752 ms
avg iteration GPU training time:21.00975418 ms
avg iteration (step) total cpu time:179.68750000 ms
Epoch Time(s): 5.0592
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.5830 | Train Acc 0.8478 | Speed (samples/sec) 179538.9335 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.63567118 ms
avg iteration GPU training time:21.12294370 ms
avg iteration (step) total cpu time:191.08731096 ms
Epoch Time(s): 5.2293
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.5611 | Train Acc 0.8576 | Speed (samples/sec) 179698.9306 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.49268081 ms
avg iteration GPU training time:20.47918823 ms
avg iteration (step) total cpu time:212.40067482 ms
Epoch Time(s): 5.3968
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.5539 | Train Acc 0.8552 | Speed (samples/sec) 179146.3014 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.83217465 ms
avg iteration GPU training time:21.12664413 ms
avg iteration (step) total cpu time:225.73369200 ms
Epoch Time(s): 5.7896
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.5497 | Train Acc 0.8538 | Speed (samples/sec) 179319.1496 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:14.87390848 ms
avg iteration GPU training time:21.74559437 ms
avg iteration (step) total cpu time:216.62928841 ms
Epoch Time(s): 5.4564
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.5583 | Train Acc 0.8564 | Speed (samples/sec) 179071.6541 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.03735577 ms
avg iteration GPU training time:20.62987050 ms
avg iteration (step) total cpu time:167.96289791 ms
Epoch Time(s): 4.9828
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.5370 | Train Acc 0.8615 | Speed (samples/sec) 179029.6203 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.37172647 ms
avg iteration GPU training time:21.12060217 ms
avg iteration (step) total cpu time:176.13866112 ms
Epoch Time(s): 5.0397
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.5597 | Train Acc 0.8582 | Speed (samples/sec) 179125.6527 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:17.40174554 ms
avg iteration GPU training time:21.46072717 ms
avg iteration (step) total cpu time:212.44985407 ms
Epoch Time(s): 5.3772
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.5540 | Train Acc 0.8561 | Speed (samples/sec) 178489.6334 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

[2021-06-10 07:26:58,233] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:26:58,234] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=5036.5542825249795
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.87661674 ms
avg iteration GPU training time:22.37023440 ms
avg iteration (step) total cpu time:178.54335091 ms
Epoch Time(s): 5.0792
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.5606 | Train Acc 0.8518 | Speed (samples/sec) 178543.9054 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.72659206 ms
avg iteration GPU training time:20.54826182 ms
avg iteration (step) total cpu time:171.25231569 ms
Epoch Time(s): 4.9799
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.5478 | Train Acc 0.8582 | Speed (samples/sec) 178696.0735 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.17875498 ms
avg iteration GPU training time:21.02329029 ms
avg iteration (step) total cpu time:213.26938542 ms
Epoch Time(s): 5.3936
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.5378 | Train Acc 0.8626 | Speed (samples/sec) 178323.7134 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.99440852 ms
avg iteration GPU training time:20.83778936 ms
avg iteration (step) total cpu time:175.77953772 ms
Epoch Time(s): 5.3514
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.5328 | Train Acc 0.8582 | Speed (samples/sec) 178479.3853 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.42720595 ms
avg iteration GPU training time:21.15152862 ms
avg iteration (step) total cpu time:185.57754430 ms
Epoch Time(s): 5.1370
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.5320 | Train Acc 0.8617 | Speed (samples/sec) 178395.4660 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.40484949 ms
avg iteration GPU training time:21.67625601 ms
avg iteration (step) total cpu time:209.60775289 ms
Epoch Time(s): 5.4225
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.5361 | Train Acc 0.8564 | Speed (samples/sec) 178558.5553 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:18.06443639 ms
avg iteration GPU training time:20.65692780 ms
avg iteration (step) total cpu time:183.86205760 ms
Epoch Time(s): 5.1647
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.5318 | Train Acc 0.8556 | Speed (samples/sec) 178539.8078 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.47772503 ms
avg iteration GPU training time:20.59247988 ms
avg iteration (step) total cpu time:171.42380368 ms
Epoch Time(s): 4.9994
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.5376 | Train Acc 0.8572 | Speed (samples/sec) 178560.2910 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.17695722 ms
avg iteration GPU training time:20.76854688 ms
avg iteration (step) total cpu time:203.37672667 ms
Epoch Time(s): 5.4194
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.5375 | Train Acc 0.8582 | Speed (samples/sec) 178772.6098 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:17.40387787 ms
avg iteration GPU training time:20.96726383 ms
avg iteration (step) total cpu time:184.52767892 ms
Epoch Time(s): 5.1778
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.5521 | Train Acc 0.8540 | Speed (samples/sec) 178814.4291 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

[2021-06-10 07:27:50,881] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:27:50,882] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=5039.94179003529
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.20646988 ms
avg iteration GPU training time:20.72157097 ms
avg iteration (step) total cpu time:229.29980538 ms
Epoch Time(s): 5.6016
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.5270 | Train Acc 0.8582 | Speed (samples/sec) 179000.8892 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.69678844 ms
avg iteration GPU training time:21.13467667 ms
avg iteration (step) total cpu time:202.23108205 ms
Epoch Time(s): 5.3557
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.5278 | Train Acc 0.8611 | Speed (samples/sec) 179093.5168 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.77461537 ms
avg iteration GPU training time:23.07156372 ms
avg iteration (step) total cpu time:178.25150490 ms
Epoch Time(s): 5.1595
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.5399 | Train Acc 0.8600 | Speed (samples/sec) 179215.6164 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.53109238 ms
avg iteration GPU training time:21.33944147 ms
avg iteration (step) total cpu time:165.98699310 ms
Epoch Time(s): 5.1185
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.5351 | Train Acc 0.8571 | Speed (samples/sec) 179421.8842 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.18084370 ms
avg iteration GPU training time:21.12800598 ms
avg iteration (step) total cpu time:200.58382641 ms
Epoch Time(s): 5.4015
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.5352 | Train Acc 0.8590 | Speed (samples/sec) 179606.7957 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:19.08909685 ms
avg iteration GPU training time:21.27570915 ms
avg iteration (step) total cpu time:181.13342198 ms
Epoch Time(s): 5.0890
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.5185 | Train Acc 0.8660 | Speed (samples/sec) 179567.8609 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.82485815 ms
avg iteration GPU training time:20.95215693 ms
avg iteration (step) total cpu time:185.29113856 ms
Epoch Time(s): 5.2199
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.5153 | Train Acc 0.8650 | Speed (samples/sec) 179691.9516 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.93037675 ms
avg iteration GPU training time:21.49680294 ms
avg iteration (step) total cpu time:212.49205416 ms
Epoch Time(s): 5.4645
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.5117 | Train Acc 0.8622 | Speed (samples/sec) 179540.7092 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.98788374 ms
avg iteration GPU training time:22.28812790 ms
avg iteration (step) total cpu time:180.66482110 ms
Epoch Time(s): 5.1339
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.5345 | Train Acc 0.8584 | Speed (samples/sec) 179599.9216 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:14.50037818 ms
avg iteration GPU training time:20.29522064 ms
avg iteration (step) total cpu time:189.72661278 ms
Epoch Time(s): 5.2169
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.5397 | Train Acc 0.8580 | Speed (samples/sec) 179897.8471 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

[2021-06-10 07:28:43,320] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:28:43,320] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=5033.270452922507
-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.18265603 ms
avg iteration GPU training time:20.98164056 ms
avg iteration (step) total cpu time:196.33052566 ms
Epoch Time(s): 5.2781
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.5341 | Train Acc 0.8629 | Speed (samples/sec) 179999.1222 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:19.77419307 ms
avg iteration GPU training time:21.33528155 ms
avg iteration (step) total cpu time:181.97874589 ms
Epoch Time(s): 5.2714
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.5336 | Train Acc 0.8578 | Speed (samples/sec) 180004.2832 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.24166402 ms
avg iteration GPU training time:20.99310563 ms
avg iteration (step) total cpu time:173.85315895 ms
Epoch Time(s): 5.0893
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.5117 | Train Acc 0.8635 | Speed (samples/sec) 180117.8336 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:15.91112718 ms
avg iteration GPU training time:21.03207259 ms
avg iteration (step) total cpu time:190.79028476 ms
Epoch Time(s): 5.3752
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4988 | Train Acc 0.8661 | Speed (samples/sec) 180319.8852 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.22383421 ms
avg iteration GPU training time:23.90258616 ms
avg iteration (step) total cpu time:173.13647270 ms
Epoch Time(s): 5.1560
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5270 | Train Acc 0.8611 | Speed (samples/sec) 180226.2115 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:14.94559097 ms
avg iteration GPU training time:20.75504286 ms
avg iteration (step) total cpu time:186.82100556 ms
Epoch Time(s): 5.2830
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.5097 | Train Acc 0.8652 | Speed (samples/sec) 180473.1184 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:17.22352860 ms
avg iteration GPU training time:21.04132930 ms
avg iteration (step) total cpu time:195.43292306 ms
Epoch Time(s): 5.3013
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5211 | Train Acc 0.8624 | Speed (samples/sec) 180485.4419 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.05977292 ms
avg iteration GPU training time:20.71667498 ms
avg iteration (step) total cpu time:191.40178507 ms
Epoch Time(s): 5.2727
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5164 | Train Acc 0.8669 | Speed (samples/sec) 180618.3385 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.21799270 ms
avg iteration GPU training time:20.80992283 ms
avg iteration (step) total cpu time:172.70367796 ms
Epoch Time(s): 5.1439
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5201 | Train Acc 0.8617 | Speed (samples/sec) 180551.5980 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57080078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.51219203 ms
avg iteration GPU training time:20.73292247 ms
avg iteration (step) total cpu time:195.44581933 ms
Epoch Time(s): 5.4055
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5047 | Train Acc 0.8672 | Speed (samples/sec) 180541.5335 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60205078125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

[2021-06-10 07:29:35,801] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-10 07:29:35,801] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=5016.786976758992
-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:16.22673173 ms
avg iteration GPU training time:22.67599695 ms
avg iteration (step) total cpu time:178.19294063 ms
Epoch Time(s): 5.1821
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5239 | Train Acc 0.8617 | Speed (samples/sec) 180642.0004 | GPU 2037.6 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60400390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62353515625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64892578125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57275390625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57666015625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 4.60009765625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 4.62158203125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 4.64697265625GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 4.57470703125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 4.59814453125GB

Max Memory Allocated 1.9898104667663574  GigaBytes

avg iteration(step) data from cpu to GPU time:14.53676519 ms
avg iteration GPU training time:20.89970901 ms
avg iteration (step) total cpu time:161.10285846 ms
Epoch Time(s): 5.0928
Eval Acc 0.8721
Test Acc: 0.6940
Avg epoch time(time.time()): 5271.609477698803 ms
total avg iteration(step) data from cpu to GPU time:16.45922329 ms
total avg iteration GPU training time:21.21308205 ms
total avg iteration (step) total cpu time:189.27921528 ms
